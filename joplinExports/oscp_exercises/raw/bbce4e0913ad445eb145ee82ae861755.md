Exercises

# 7.1.6.3.
## 7.1.6.3.1. Find the DNS servers for the megacorpone.com domain.

### Forward Lookup Brute Force
The domain is megacorpone.com. Perform DNS queries to discover hostnames and IP addresses. We will use /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt as possible hostnames

```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ for ip in $(cat /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt); do host $ip.megacorpone.com; done | grep -v "not found"
www.megacorpone.com has address 3.220.87.155
mail.megacorpone.com has address 3.220.61.179
ns1.megacorpone.com has address 3.220.61.179
ns2.megacorpone.com has address 3.211.51.86
test.megacorpone.com has address 3.220.61.179
www2.megacorpone.com has address 3.220.61.179
ns3.megacorpone.com has address 3.212.85.86
admin.megacorpone.com has address 3.220.61.179
mail2.megacorpone.com has address 3.220.61.179
vpn.megacorpone.com has address 3.220.61.179
beta.megacorpone.com has address 3.220.61.179
support.megacorpone.com has address 3.212.85.86
intranet.megacorpone.com has address 3.220.61.179
router.megacorpone.com has address 3.220.61.179
MAIL.megacorpone.com has address 3.220.61.179
syslog.megacorpone.com has address 3.220.61.179
WWW.megacorpone.com has address 3.220.87.155
NS1.megacorpone.com has address 3.220.61.179
NS2.megacorpone.com has address 3.211.51.86
fs1.megacorpone.com has address 3.220.61.179
NS3.megacorpone.com has address 3.212.85.86
snmp.megacorpone.com has address 3.220.61.179
VPN.megacorpone.com has address 3.220.61.179
BETA.megacorpone.com has address 3.220.61.179
ROUTER.megacorpone.com has address 3.220.61.179
TEST.megacorpone.com has address 3.220.61.179
ADMIN.megacorpone.com has address 3.220.61.179
Intranet.megacorpone.com has address 3.220.61.179
siem.megacorpone.com has address 3.220.61.179
```

### Reverse Lookup Brute Force 
When we sort for unique IPs, we find four of them:
3.211.51.86
3.212.85.86
3.220.61.179
3.220.87.155

Perform dns reverse lookup brute force on these 4 unique IPs. However, we were not able to resolve any more hostnames for megacorpone.com

Scan for additional hostnames in range 3.211.51.X.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ for ip in $(seq 1 254); do host 3.211.51.$ip; done | grep -v "not found"
1.51.211.3.in-addr.arpa domain name pointer ec2-3-211-51-1.compute-1.amazonaws.com.
2.51.211.3.in-addr.arpa domain name pointer ec2-3-211-51-2.compute-1.amazonaws.com.
3.51.211.3.in-addr.arpa domain name pointer ec2-3-211-51-3.compute-1.amazonaws.com.
...
```

Scan for additional hostnames in range 3.212.85.X.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ for ip in $(seq 1 254); do host 3.212.85.$ip; done | grep -v "not found"
1.85.212.3.in-addr.arpa domain name pointer ec2-3-212-85-1.compute-1.amazonaws.com.
2.85.212.3.in-addr.arpa domain name pointer ec2-3-212-85-2.compute-1.amazonaws.com.
3.85.212.3.in-addr.arpa domain name pointer ec2-3-212-85-3.compute-1.amazonaws.com.
...
```

Scan for additional hostnames in range 3.220.61.X.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ for ip in $(seq 1 254); do host 3.220.61.$ip; done | grep -v "not found"
1.61.220.3.in-addr.arpa domain name pointer ec2-3-220-61-1.compute-1.amazonaws.com.
2.61.220.3.in-addr.arpa domain name pointer ec2-3-220-61-2.compute-1.amazonaws.com.
3.61.220.3.in-addr.arpa domain name pointer ec2-3-220-61-3.compute-1.amazonaws.com.
```

Scan for additional hostnames in range 3.220.87.X.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ for ip in $(seq 1 254); do host 3.220.87.$ip; done | grep -v "not found"
1.87.220.3.in-addr.arpa domain name pointer ec2-3-220-87-1.compute-1.amazonaws.com.
2.87.220.3.in-addr.arpa domain name pointer ec2-3-220-87-2.compute-1.amazonaws.com.
3.87.220.3.in-addr.arpa domain name pointer ec2-3-220-87-3.compute-1.amazonaws.com.
```


## 7.1.6.3.2. Write a small script to attempt a zone transfer from megacorpone.com using a higher-level scripting language such as Python, Perl, or Ruby.

```python
#!/usr/bin/python

import sys, getopt
import os

# Simple Zone Transfer Bash Script
# $1 is the first argument given after the bash script
# Check if argument was given, if not, print usage

def main(argv):
  domain = ''
  # Name servers
  ns = []
  # Zone transfers
  zt = []
  try:
    opts, args = getopt.getopt(argv,"hd:",["domain="])
  except getopt.GetoptError:
    print "[*] Simple Zone transfer script"
    print '[*] Usage:   python zonetransfer.py -d <domain name>'
    sys.exit(2)
  for opt,arg in opts:
    if opt == '-h':
      print "[*] Simple Zone transfer script"
      print '[*] Usage:   python zonetransfer.py -d <domain name>'
      sys.exit()
    elif opt in ("-d", "--domain"):
      domain=arg

  # Command to get name server IPs
  ns_cmd = 'host -t ns %s | cut -d " " -f4' % domain

  stream = os.popen(ns_cmd)
  output = stream.read().split("\n")
  for o in output:
    if o != '':
      ns.append(o)
  
  # Command to do zone transfer
  for n in ns:
    z_cmd = 'host -l %s %s | grep "has address"' % (domain,n)
    stream = os.popen(z_cmd)
    output = stream.read().split("\n")
    for o in output:
      if o != '':
        print o

if __name__ == "__main__":
  main(sys.argv[1:])

```

## 7.1.6.3.3. Recreate the example above and use dnsrecon to attempt a zone transfer from megacorpone.com
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ dnsrecon -d megacorpone.com -t axfr
[*] Testing NS Servers for Zone Transfer
[*] Checking for Zone Transfer for megacorpone.com name servers
[*] Resolving SOA Record
[+] 	 SOA ns1.megacorpone.com 3.220.61.179
[*] Resolving NS Records
[*] NS Servers found:
[*] 	NS ns1.megacorpone.com 3.220.61.179
[*] 	NS ns3.megacorpone.com 3.212.85.86
[*] 	NS ns2.megacorpone.com 3.211.51.86
[*] Removing any duplicate NS server IP Addresses...
[*]  
[*] Trying NS server 3.212.85.86
[+] 3.212.85.86 Has port 53 TCP Open
[-] Zone Transfer Failed!
[-] No answer or RRset not for qname
[*]  
[*] Trying NS server 3.211.51.86
[+] 3.211.51.86 Has port 53 TCP Open
[+] Zone Transfer was successful!!
[*] 	 NS ns1.megacorpone.com 3.220.61.179
[*] 	 NS ns2.megacorpone.com 3.211.51.86
[*] 	 NS ns3.megacorpone.com 3.212.85.86
[*] 	 TXT Try Harder
[*] 	 TXT google-site-verification=U7B_b0HNeBtY4qYGQZNsEYXfCJ32hMNV3GtC0wWq5pA
[*] 	 MX @.megacorpone.com fb.mail.gandi.net 217.70.178.217
[*] 	 MX @.megacorpone.com spool.mail.gandi.net 217.70.178.1
[*] 	 A admin.megacorpone.com 3.220.61.179
[*] 	 A fs1.megacorpone.com 3.220.61.179
[*] 	 A www2.megacorpone.com 3.220.61.179
[*] 	 A test.megacorpone.com 3.220.61.179
[*] 	 A ns1.megacorpone.com 3.220.61.179
[*] 	 A ns2.megacorpone.com 3.211.51.86
[*] 	 A ns3.megacorpone.com 3.212.85.86
[*] 	 A www.megacorpone.com 3.220.87.155
[*] 	 A siem.megacorpone.com 3.220.61.179
[*] 	 A mail2.megacorpone.com 3.220.61.179
[*] 	 A router.megacorpone.com 3.220.61.179
[*] 	 A mail.megacorpone.com 3.220.61.179
[*] 	 A vpn.megacorpone.com 3.220.61.179
[*] 	 A snmp.megacorpone.com 3.220.61.179
[*] 	 A syslog.megacorpone.com 3.220.61.179
[*] 	 A beta.megacorpone.com 3.220.61.179
[*] 	 A intranet.megacorpone.com 3.220.61.179
[*] 	 A support.megacorpone.com 3.212.85.86
[*]  
[*] Trying NS server 3.220.61.179
[+] 3.220.61.179 Has port 53 TCP Open
[-] Zone Transfer Failed!
[-] No answer or RRset not for qname
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$
```

# 7.2.2.9
## 7.2.2.9.1. Use Nmap to conduct a ping sweep of your target IP range and save the output to a file. Use grep to show machines that are online.

Use NMAP to perform ping sweep of 10.11.1.1-254 and save to file ping-sweep.txt
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sn 10.11.1.1-254 -oG ping-sweep.txt
```

Grep ping-sweep.txt for online hosts
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat ping-sweep.txt | grep "Status: Up" | awk -F" " '{ print $2}'
10.11.1.5
10.11.1.8
10.11.1.13
10.11.1.14
10.11.1.20
10.11.1.21
10.11.1.22
10.11.1.24
10.11.1.31
10.11.1.35
10.11.1.39
10.11.1.44
10.11.1.50
10.11.1.71
10.11.1.72
10.11.1.73
10.11.1.75
10.11.1.79
10.11.1.101
10.11.1.111
10.11.1.115
10.11.1.116
10.11.1.120
10.11.1.121
10.11.1.122
10.11.1.123
10.11.1.128
10.11.1.133
10.11.1.136
10.11.1.141
10.11.1.146
10.11.1.209
10.11.1.217
10.11.1.220
10.11.1.221
10.11.1.222
10.11.1.223
10.11.1.227
10.11.1.229
10.11.1.231
10.11.1.234
10.11.1.237
10.11.1.250
10.11.1.251
```

## 7.2.2.9.2. Scan the IP addresses you found in exercise 1 for open webserver ports. Use Nmap to find the webserver and operating system versions.

Grep ping-sweep.txt to only output the IP addresses, and write to file online_hosts.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat ping-sweep.txt | grep "Status: Up" | awk -F" " '{ print $2}' > online_hosts
```

Use file 'online_hosts' as input for the nmap command to find hosts that are running a web server on port 80.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p 80 -iL online_hosts -oG web-sweep.txt
```

Grep web-sweep.txt for the web server hosts
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ grep open web-sweep.txt | cut -d" " -f2
10.11.1.8
10.11.1.14
10.11.1.21
10.11.1.31
10.11.1.35
10.11.1.39
10.11.1.50
10.11.1.71
10.11.1.72
10.11.1.101
10.11.1.115
10.11.1.116
10.11.1.123
10.11.1.133
10.11.1.217
10.11.1.223
10.11.1.227
10.11.1.229
10.11.1.234
10.11.1.237
10.11.1.250
10.11.1.251
```

## 7.2.2.9.3. Use NSE scripts to scan the machines in the labs that are running the SMB service.

### Check the usage for the smb-os-discover.nse script. We see that scanning for port 445 is for SMB over IP, and scanning for UDP137/TCP139 is for SMB over NETBIOS.
```plaintext
kali@kali:/usr/share/nmap/scripts$ cat smb-os-discovery.nse 
...
--@usage
-- nmap --script smb-os-discovery.nse -p445 127.0.0.1
-- sudo nmap -sU -sS --script smb-os-discovery.nse -p U:137,T:139 127.0.0.1
--
...
```

### Check for SMB over IP (port 445)
Run smb-os-discovery for SMB over IP and save to file
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -iL online_hosts -p 445 --script=smb-os-discovery -oG smb-overip-sweep.txt
```
Grep the smb-overip-sweep.txt file to find hosts running SMB over IP.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat smb-overip-sweep.txt | grep -e Windows -e smbd | awk -F" " '{print $2}'
10.11.1.8
10.11.1.22
10.11.1.24
10.11.1.31
10.11.1.73
10.11.1.75
10.11.1.101
10.11.1.136
10.11.1.146
10.11.1.220
10.11.1.227
10.11.1.231
```

### Check for SMB over NETBIOS
Run smb-os-discovery to check for SMB over NETBIOS, and save to file.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sU -sS --script smb-os-discovery.nse -p U:137-138,T:139 -iL online_hosts -oG smb-netbios-sweep.txt
```

Grep smb-netbios-sweep.txt to find hosts running SMB over NETBIOS
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat smb-netbios-sweep.txt | grep -e Windows -e smb | awk -F" " '{print $2}'
Nmap
10.11.1.5
10.11.1.75
10.11.1.101
10.11.1.136
10.11.1.146
10.11.1.227
10.11.1.231
```

### We could also just combine both types of SMB into one command:
Find hosts running any SMB protocol
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -iL online_hosts -p "U:137-138,T:139,445" --script=smb-os-discovery -oG smb-sweep.txt
```

Grep smb-sweep.txt and we see that a total of 14 hosts are running SMB.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat smb-sweep.txt | grep -e Windows -e smb | awk -F" " '{print $2}'
Nmap
10.11.1.5
10.11.1.8
10.11.1.22
10.11.1.24
10.11.1.31
10.11.1.73
10.11.1.75
10.11.1.101
10.11.1.136
10.11.1.146
10.11.1.220
10.11.1.227
10.11.1.231
```


## 7.2.2.9.4. Use Wireshark to capture a Nmap connect and UDP scan and compare it against the Netcat port scans. Are they the same or different?

YES they are DIFFERENT. NMAP sends extra requests by default (ie. ICMP Echo, TCP 80 and TP 443, whether or not it's a TCP or UDP scan. Netcat sends packets exactly as requested.

### TCP CONNECT scan ports 3388-3390
NMAP
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sT -p3388-3390 10.11.1.223
```
![2fe86f2278fbfe84223540c3406ca5e1.png](:/4a3089813ec34936aa16614592baef4e)

Netcat
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ nc -nvv -w 1 -z 10.11.1.223 3388-3390
```
![9671c2795c447512233e181c8e2e4222.png](:/64d2c9ca7867424ca2a86c1e29c29e9d)

### UDP scan ports 160-162
NMAP
```plaintest
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sU -p160-162 10.11.1.223
```
![ac60d38f8dc88234151a341b35242803.png](:/4ae7c15b5603466b9a01057a74ccf9ef)

Netcat
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ nc -nv -u -z -w 1 10.11.1.223 160-162
```
![4ff74c1464205bb3af581893ac92916c.png](:/e8bc15e57d3542dfbc1c694a7e32751a)


## 7.2.2.9.5. Use Wireshark to capture a Nmap SYN scan and compare it to a connect scan and identify the difference between them.

SYN stealth scans are quicker than CONNECT scans. This is because SYN scans do not complete a 3-way handshake with an ACK. Instead it sends a RST packet.

TCP Connect scans are slower. Such scans make a full connection with the target machine (completes a 3-way handshake).

TCP CONNECT scan
```
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sT -p 21-25 10.11.1.14
```
![e9d067fa623e1b7bb2d1edaedd8ac976.png](:/f3dee9a832f141878718e7c3090ae16f)

TCP SYN scan
```
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sS -p 21-25 10.11.1.14
```
![505b12d0a64be103cb44f92c66005c32.png](:/11397f41b78d43379e028ed8806be859)



# 7.3.2.1

## 7.3.2.1.1. Use Nmap to make a list of the SMB servers in the lab that are running Windows.
Run the smb-os-discovery script
```
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p139,445 -sV -O --script=smb-os-discovery 10.11.1.1-254 -oG smbDiscovery.txt
```
Grep for Windows machines. We find 19.
``` plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p139,445 --script "*smb*vuln*" -iL smb_hosts.txt
10.11.1.5
10.11.1.13
10.11.1.20
10.11.1.21
10.11.1.22
10.11.1.24
10.11.1.31
10.11.1.73
10.11.1.75
10.11.1.111
10.11.1.120
10.11.1.121
10.11.1.122
10.11.1.123
10.11.1.128
10.11.1.220
10.11.1.222
10.11.1.223
10.11.1.227
```

## 7.3.2.1.2. Use NSE scripts to scan these systems for SMB vulnerabilities.

Run the smb vuln scripts pertaining to smb on the Windows hosts. There is a limitation to using -oG files; it did not write which targets are vulnerable. On checking stdout, the 3 are vulnerable:
10.11.1.5
10.11.1.75
10.11.1.227
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p139,445 --script "*smb*vuln*" -iL smb_hosts.txt
Nmap scan report for 10.11.1.5
Host is up (0.023s latency).

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|           
|     Disclosure date: 2008-10-23
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
...
Nmap scan report for 10.11.1.75
Host is up (0.023s latency).

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
...
Nmap scan report for 10.11.1.227
Host is up (0.024s latency).

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2008-4250
|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,
|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary
|           code via a crafted RPC request that triggers the overflow during path canonicalization.
|           
|     Disclosure date: 2008-10-23
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
...
```

## 7.3.2.1.3. Use nbtscan and enum4linux against these systems to identify the types of data you can obtain from different versions of Windows.

10.11.1.5 = Windows XP
10.11.1.75 = Windows 8.1 Enterprise 6.3
10.11.1.227 = Windows 2000 LAN Manager

### nbtscan
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nbtscan -r -f smb_hosts.txt 
[sudo] password for kali: 
Doing NBT name scan for addresses from smb_hosts.txt

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
10.11.1.5        ALICE            <server>  ALICE            00:50:56:8a:99:02
10.11.1.227      JD               <server>  ADMINISTRATOR    00:50:56:8a:d9:d9
10.11.1.75       BRUCE            <server>  <unknown>        00:50:56:8a:77:95
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ 

```
### enum4linux
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ enum4linux -a 10.11.1.5
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Sep 19 15:43:21 2020

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.11.1.5
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ================================================= 
|    Enumerating Workgroup/Domain on 10.11.1.5    |
 ================================================= 
[+] Got domain/workgroup name: THINC

 ========================================= 
|    Nbtstat Information for 10.11.1.5    |
 ========================================= 
Looking up status of 10.11.1.5
        ALICE           <00> -         B <ACTIVE>  Workstation Service
        THINC           <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
        ALICE           <03> -         B <ACTIVE>  Messenger Service
        ALICE           <20> -         B <ACTIVE>  File Server Service
        THINC           <1e> - <GROUP> B <ACTIVE>  Browser Service Elections
        THINC           <1d> -         B <ACTIVE>  Master Browser
        ..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser

        MAC Address = 00-50-56-8A-99-02

 ================================== 
|    Session Check on 10.11.1.5    |
 ================================== 
[E] Server doesn't allow session using username '', password ''.  Aborting remainder of tests.

kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ enum4linux -a 10.11.1.75
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Sep 19 14:30:52 2020

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.11.1.75
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ================================================== 
|    Enumerating Workgroup/Domain on 10.11.1.75    |
 ================================================== 
[+] Got domain/workgroup name: WORKGROUP

 ========================================== 
|    Nbtstat Information for 10.11.1.75    |
 ========================================== 
Looking up status of 10.11.1.75
        BRUCE           <20> -         B <ACTIVE>  File Server Service
        BRUCE           <00> -         B <ACTIVE>  Workstation Service
        WORKGROUP       <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name

        MAC Address = 00-50-56-8A-11-85

 =================================== 
|    Session Check on 10.11.1.75    |
 =================================== 
[+] Server 10.11.1.75 allows sessions using username '', password ''

 ========================================= 
|    Getting domain SID for 10.11.1.75    |
 ========================================= 
could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED
could not obtain sid from server
error: NT_STATUS_ACCESS_DENIED
[+] Can't determine if host is part of domain or part of a workgroup

 ==================================== 
|    OS information on 10.11.1.75    |
 ==================================== 
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for 10.11.1.75 from smbclient: 
[E] Can't get OS info with srvinfo: NT_STATUS_ACCESS_DENIED

 =========================== 
|    Users on 10.11.1.75    |
 =========================== 
[E] Couldn't find users using querydispinfo: NT_STATUS_ACCESS_DENIED

[E] Couldn't find users using enumdomusers: NT_STATUS_ACCESS_DENIED

 ======================================= 
|    Share Enumeration on 10.11.1.75    |
 ======================================= 

        Sharename       Type      Comment
        ---------       ----      -------
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on 10.11.1.75

 ================================================== 
|    Password Policy Information for 10.11.1.75    |
 ================================================== 
[E] Unexpected error from polenum:


[+] Attaching to 10.11.1.75 using a NULL share

[+] Trying protocol 139/SMB...

        [!] Protocol failed: Cannot request session (Called Name:10.11.1.75)

[+] Trying protocol 445/SMB...

        [!] Protocol failed: Missing required parameter 'digestmod'.


[E] Failed to get password policy with rpcclient


 ============================ 
|    Groups on 10.11.1.75    |
 ============================ 

[+] Getting builtin groups:
[E] Can't get builtin groups: NT_STATUS_ACCESS_DENIED

[+] Getting builtin group memberships:

[+] Getting local groups:
[E] Can't get local groups: NT_STATUS_ACCESS_DENIED

[+] Getting local group memberships:

[+] Getting domain groups:
[E] Can't get domain groups: NT_STATUS_ACCESS_DENIED

[+] Getting domain group memberships:

 ===================================================================== 
|    Users on 10.11.1.75 via RID cycling (RIDS: 500-550,1000-1050)    |
 ===================================================================== 
[E] Couldn't get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.

 =========================================== 
|    Getting printer info for 10.11.1.75    |
 =========================================== 
could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED
could not obtain sid from server
error: NT_STATUS_ACCESS_DENIED


enum4linux complete on Sat Sep 19 14:30:56 2020
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ enum4linux -a 10.11.1.227
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sat Sep 19 14:31:45 2020

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.11.1.227
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 =================================================== 
|    Enumerating Workgroup/Domain on 10.11.1.227    |
 =================================================== 
[+] Got domain/workgroup name: WORKGROUP

 =========================================== 
|    Nbtstat Information for 10.11.1.227    |
 =========================================== 
Looking up status of 10.11.1.227
        JD              <00> -         M <ACTIVE>  Workstation Service
        JD              <03> -         M <ACTIVE>  Messenger Service
        WORKGROUP       <00> - <GROUP> M <ACTIVE>  Domain/Workgroup Name
        ADMINISTRATOR   <03> -         M <ACTIVE>  Messenger Service
        JD              <20> -         M <ACTIVE>  File Server Service
        WORKGROUP       <1e> - <GROUP> M <ACTIVE>  Browser Service Elections
        INet~Services   <1c> - <GROUP> M <ACTIVE>  IIS
        IS~JD           <00> -         M <ACTIVE>  IIS

        MAC Address = 00-50-56-8A-D9-D9

 ==================================== 
|    Session Check on 10.11.1.227    |
 ==================================== 
[E] Server doesn't allow session using username '', password ''.  Aborting remainder of tests.
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering
```

# 7.4.2.1
## 7.4.2.1.1. Use Nmap to make a list of machines running NFS in the labs.
Run NMAP to scan for port 111
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p 111 10.11.1.1-254 -oG nfs_111.txt
```

Grep for the IPs that have port 111 open
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat nfs_111.txt | grep open | awk -F" " '{ print $2 }' > nfs_111open.txt
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat nfs_111open.txt 
10.11.1.8
10.11.1.72
10.11.1.115
10.11.1.141
10.11.1.209
10.11.1.217
10.11.1.231
10.11.1.237
```

Run to see what services may be registered with rpcbind. We see that 10.11.1.72 has nfs shares, but 10.11.1.231 and 10.11.1.237 do not have nfs shares
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p 111 --script=rpcinfo -iL nsf_111open.txt  -oG rpcinfo.txt
...
Nmap scan report for 10.11.1.72
Host is up (0.025s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/tcp6  nfs
|   100003  2,3,4       2049/udp   nfs
|   100003  2,3,4       2049/udp6  nfs
|   100005  1,2,3      40052/tcp   mountd
|   100005  1,2,3      49168/udp6  mountd
|   100005  1,2,3      55058/tcp6  mountd
|   100005  1,2,3      56880/udp   mountd
|   100021  1,3,4      35251/udp6  nlockmgr
|   100021  1,3,4      49145/tcp6  nlockmgr
|   100021  1,3,4      53616/udp   nlockmgr
|   100021  1,3,4      59027/tcp   nlockmgr
|   100024  1          37599/tcp6  status
|   100024  1          42399/udp6  status
|   100024  1          48059/udp   status
|   100024  1          57297/tcp   status
|   100227  2,3         2049/tcp   nfs_acl
|   100227  2,3         2049/tcp6  nfs_acl
|   100227  2,3         2049/udp   nfs_acl
|_  100227  2,3         2049/udp6  nfs_acl
...
Nmap scan report for 10.11.1.231
Host is up (0.025s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|_  100000  3,4          111/udp6  rpcbind

Nmap scan report for 10.11.1.237
Host is up (0.025s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          33242/tcp   status
|   100024  1          36278/tcp6  status
|   100024  1          40221/udp6  status
|_  100024  1          47805/udp   status

Nmap done: 8 IP addresses (8 hosts up) scanned in 4.69 seconds
```


```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat rpcinfo.txt | grep RPC | awk -F" " '{ print $2 }'
10.11.1.72
10.11.1.231
10.11.1.237
```
## 7.4.2.1.2. Use NSE scripts to scan these systems and collect additional information about accessible shares.
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -p 111 --script "nfs*" 10.11.1.72
[sudo] password for kali: 
Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-19 15:57 EDT
Nmap scan report for 10.11.1.72
Host is up (0.018s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| nfs-ls: Volume /home
|   access: Read Lookup NoModify NoExtend NoDelete NoExecute
| PERMISSION  UID   GID   SIZE  TIME                 FILENAME
| drwxr-xr-x  0     0     4096  2015-09-17T13:21:59  .
| drwxr-xr-x  0     0     4096  2015-01-07T10:56:34  ..
| drwxr-xr-x  1013  1013  4096  2015-09-17T13:21:47  jenny
| drwxr-xr-x  1012  1012  4096  2015-09-17T13:21:40  joe45
| drwxr-xr-x  1011  1011  4096  2015-09-17T13:21:52  john
| drwxr-xr-x  1014  1014  4096  2019-10-27T23:48:51  marcus
| drwxr-x---  0     1010  4096  2015-01-08T16:01:31  ryuu
|_
| nfs-showmount: 
|_  /home 10.11.0.0/255.255.0.0
| nfs-statfs: 
|   Filesystem  1K-blocks  Used       Available  Use%  Maxfilesize  Maxlink
|_  /home       7223800.0  2076352.0  4780500.0  31%   8.0T         32000

Nmap done: 1 IP address (1 host up) scanned in 0.89 seconds
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ 
```

# 7.5.1.1
## 7.5.1.1.1. Search your target network range to see if you can identify any systems that respond to the SMTP VRFY command.

NMAP scan
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap --script smtp-enum-users.nse --script-args VRFY -p 25 10.11.1.0/24 -oG smtp_vrfy.txt
```

Grep for the hosts the hosts that have open ports
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat smtp_vrfy.txt | grep open | awk -F" " '{ print $2 }'
10.11.1.72
10.11.1.115
10.11.1.217
10.11.1.227
10.11.1.231
```

These
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nc -nv 10.11.1.115 25 
(UNKNOWN) [10.11.1.115] 25 (smtp) open
220 tophat.acme.com ESMTP Sendmail 8.12.8/8.12.8; Sat, 19 Sep 2020 23:26:17 +0300
VRFY root
250 2.1.5 root <root@tophat.acme.com>

kali@kali:~$ sudo nc -nv 10.11.1.217 25
(UNKNOWN) [10.11.1.217] 25 (smtp) open
VRFY root
220 hotline.localdomain ESMTP Postfix
252 2.0.0 

kali@kali:~$ sudo nc -nv 10.11.1.231 25
(UNKNOWN) [10.11.1.231] 25 (smtp) open
220 mail.local ESMTP Postfix (Debian/GNU)
VRFY root
252 2.0.0 root

```
## 7.5.1.1.2. Try using this Python code to automate the process of username discovery using a text file with usernames as input.

I downloaded a list of possible usernames from https://github.com/pentestmonkey/yaptest/blob/master/smtp-usernames.txt

Here is the python code
```python
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat vrfy.py 
#!/usr/bin/python

import socket
import sys, getopt

def main(argv):
  # A single user name
  user=''
  # A filename of usernames
  fn=''
  # List of users to check
  ulst=[]
  if len(argv) != 2:
    print "[*] VRFY username script"
    print '[*] Usage:   python vrfy.py -f <list of usernames>'
    print '[*] Usage:   python vrfy.py -u <list of usernames>'
    sys.exit(0)
  try:
    opts, args = getopt.getopt(argv,"hu:f:",["user=","fname="])
  except getopt.GetoptError:
    print "[*] VRFY username script"
    print '[*] Usage:   python vrfy.py -f <list of usernames>'
    print '[*] Usage:   python vrfy.py -u <list of usernames>'
    sys.exit(2)
  for opt,arg in opts:
    if opt == '-h':
      print "[*] VRFY username script"
      print '[*] Usage:   python vrfy.py -f <list of usernames>'
      print '[*] Usage:   python vrfy.py -u <list of usernames>'
      sys.exit()
    elif opt in ("-u", "--user"):
      user=arg.strip()
    elif opt in ("-f", "--fname"):
      fn=arg
  
    
  # Create a Socket
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

  # Connect to the Server
  connect = s.connect(('10.11.1.217',25))

  # Receive the banner
  banner = s.recv(1024)

  print banner

  if user:
    s.send('VRFY ' + user + '\r\n')
    result = s.recv(1024)
    print result
  if fn:
    names = open(fn,"r")
    for n in names:
      s.send('VRFY ' + n.strip() + '\r\n')
      result = s.recv(1024)
      print result
    names.close()

  # Close the socket
  s.close()

if __name__=="__main__":
  main(sys.argv[1:])
```

Here is the output from running the script
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ python vrfy.py -f smtp-usernames.txt
220 hotline.localdomain ESMTP Postfix

252 2.0.0 adm

252 2.0.0 apache

550 5.1.1 <at>: Recipient address rejected: User unknown in local recipient table

550 5.1.1 <bb>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 bin

550 5.1.1 <cron>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 daemon

550 5.1.1 <db2fenc1>: Recipient address rejected: User unknown in local recipient table

550 5.1.1 <db2inst1>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 ftp

252 2.0.0 games

252 2.0.0 gdm

550 5.1.1 <guest>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 halt

252 2.0.0 lp

252 2.0.0 mail

550 5.1.1 <man>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 mysql

252 2.0.0 named

252 2.0.0 news

252 2.0.0 nobody

252 2.0.0 ntp

252 2.0.0 operator

550 5.1.1 <oracle>: Recipient address rejected: User unknown in local recipient table

550 5.1.1 <oracle8>: Recipient address rejected: User unknown in local recipient table

550 5.1.1 <portage>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 postfix

252 2.0.0 postgres

252 2.0.0 postmaster

550 5.1.1 <public>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 root

252 2.0.0 rpc

252 2.0.0 shutdown

252 2.0.0 squid

252 2.0.0 sshd

252 2.0.0 sync

252 2.0.0 system

550 5.1.1 <test>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 toor

550 5.1.1 <user>: Recipient address rejected: User unknown in local recipient table

252 2.0.0 uucp

550 5.1.1 <websphere>: Recipient address rejected: User unknown in local recipient table

kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ 
```


# 7.6.3.6
## 7.6.3.6.1. Scan your target network with onesixtyone to identify any SNMP servers.

Run an NMAP scan for open UDP port 161
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ sudo nmap -sU --open -p 161 10.11.1.1-254 -oG open-snmp.txt
```

Grep for IPs with open UDP ports
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ cat open-snmp.txt | grep open | grep -v Nmap | awk -F" " '{ print $2 }'
```

Create the public strings
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ echo public >> community
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ echo private >> community
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ echo manager >> community
```

Run the onesixtyone command
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ onesixtyone -c community -i snmp_targets.txt -o 161out.txtLogging to file 161out.txt
Scanning 12 hosts, 4 communities
10.11.1.115 [public] Linux tophat.acme.com 2.4.20-8 #1 Thu Mar 13 17:54:28 EST 2003 i686
10.11.1.227 [public] Hardware: x86 Family 6 Model 15 Stepping 1 AT/AT COMPATIBLE - Software: Windows 2000 Version 5.0 (Build 2195 Uniprocessor Free)
```

## 7.6.3.6.2. Use snmpwalk and snmp-check to gather information about the discovered targets.

### SNMP Server 10.11.1.115
Enumerating the MIB tree
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 -t 10 10.11.1.115
iso.3.6.1.2.1.1.1.0 = STRING: "Linux tophat.acme.com 2.4.20-8 #1 Thu Mar 13 17:54:28 EST 2003 i686"
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10
iso.3.6.1.2.1.1.3.0 = Timeticks: (2080701154) 240 days, 19:43:31.54
iso.3.6.1.2.1.1.4.0 = STRING: "Root <root@localhost> (configure /etc/snmp/snmp.local.conf)"
iso.3.6.1.2.1.1.5.0 = STRING: "tophat.acme.com"
iso.3.6.1.2.1.1.6.0 = STRING: "Unknown (edit /etc/snmp/snmpd.conf)"
...
```
Enumerate Windows users
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.115 1.3.6.1.4.1.77.1.2.25
End of MIB
```
Enumerating Running Windows Processes
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.115 1.3.6.1.2.1.25.4.2.1.2
End of MIB
```
Enumerating Open TCP Ports
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.115 1.3.6.1.2.1.6.13.1.3
```
Enumerating Installed Software
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.115 1.3.6.1.2.1.25.6.3.1.2
End of MIB
```

### SNMP Server 10.11.1.227
Enumerating the MIB tree
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 -t 10 10.11.1.227 
iso.3.6.1.2.1.1.1.0 = STRING: "Hardware: x86 Family 6 Model 15 Stepping 1 AT/AT COMPATIBLE - Software: Windows 2000 Version 5.0 (Build 2195 Uniprocessor Free)"
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.311.1.1.3.1.2
iso.3.6.1.2.1.1.3.0 = Timeticks: (2082653103) 241 days, 1:08:51.03
iso.3.6.1.2.1.1.4.0 = ""
iso.3.6.1.2.1.1.5.0 = STRING: "JD"
iso.3.6.1.2.1.1.6.0 = ""
iso.3.6.1.2.1.1.7.0 = INTEGER: 76
iso.3.6.1.2.1.2.1.0 = INTEGER: 2
iso.3.6.1.2.1.2.2.1.1.1 = INTEGER: 1
iso.3.6.1.2.1.2.2.1.1.33554435 = INTEGER: 33554435
```
Enumerate Windows Users
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.227 1.3.6.1.4.1.77.1.2.25
iso.3.6.1.4.1.77.1.2.25.1.1.3.108.101.101 = STRING: "lee"
iso.3.6.1.4.1.77.1.2.25.1.1.3.110.101.100 = STRING: "ned"
iso.3.6.1.4.1.77.1.2.25.1.1.4.103.97.114.121 = STRING: "gary"
iso.3.6.1.4.1.77.1.2.25.1.1.4.106.111.104.110 = STRING: "john"
iso.3.6.1.4.1.77.1.2.25.1.1.4.108.105.115.97 = STRING: "lisa"
iso.3.6.1.4.1.77.1.2.25.1.1.4.109.97.114.107 = STRING: "mark"
iso.3.6.1.4.1.77.1.2.25.1.1.4.110.105.99.107 = STRING: "nick"
iso.3.6.1.4.1.77.1.2.25.1.1.4.116.111.100.100 = STRING: "todd"
iso.3.6.1.4.1.77.1.2.25.1.1.5.71.117.101.115.116 = STRING: "Guest"
iso.3.6.1.4.1.77.1.2.25.1.1.5.97.100.109.105.110 = STRING: "admin"
iso.3.6.1.4.1.77.1.2.25.1.1.5.100.97.118.105.100 = STRING: "david"
iso.3.6.1.4.1.77.1.2.25.1.1.5.104.111.109.101.114 = STRING: "homer"
iso.3.6.1.4.1.77.1.2.25.1.1.5.115.105.109.111.110 = STRING: "simon"
iso.3.6.1.4.1.77.1.2.25.1.1.6.98.97.99.107.117.112 = STRING: "backup"
iso.3.6.1.4.1.77.1.2.25.1.1.6.115.113.108.117.115.114 = STRING: "sqlusr"
iso.3.6.1.4.1.77.1.2.25.1.1.9.73.85.83.82.95.83.82.86.50 = STRING: "IUSR_SRV2"
iso.3.6.1.4.1.77.1.2.25.1.1.9.73.87.65.77.95.83.82.86.50 = STRING: "IWAM_SRV2"
iso.3.6.1.4.1.77.1.2.25.1.1.13.65.100.109.105.110.105.115.116.114.97.116.111.114 = STRING: "Administrator"
iso.3.6.1.4.1.77.1.2.25.1.1.14.84.115.73.110.116.101.114.110.101.116.85.115.101.114 = STRING: "TsInternetUser"
```

Enumerate Running Windows Processes
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.227 1.3.6.1.2.1.25.4.2.1.2
iso.3.6.1.2.1.25.4.2.1.2.1 = STRING: "System Idle Process"
iso.3.6.1.2.1.25.4.2.1.2.8 = STRING: "System"
iso.3.6.1.2.1.25.4.2.1.2.172 = STRING: "smss.exe"
iso.3.6.1.2.1.25.4.2.1.2.200 = STRING: "csrss.exe"
iso.3.6.1.2.1.25.4.2.1.2.220 = STRING: "WINLOGON.EXE"
iso.3.6.1.2.1.25.4.2.1.2.248 = STRING: "services.exe"
iso.3.6.1.2.1.25.4.2.1.2.260 = STRING: "LSASS.EXE"
iso.3.6.1.2.1.25.4.2.1.2.440 = STRING: "notepad.exe"
iso.3.6.1.2.1.25.4.2.1.2.460 = STRING: "svchost.exe"
iso.3.6.1.2.1.25.4.2.1.2.488 = STRING: "SPOOLSV.EXE"
iso.3.6.1.2.1.25.4.2.1.2.520 = STRING: "msdtc.exe"
iso.3.6.1.2.1.25.4.2.1.2.580 = STRING: "explorer.exe"
iso.3.6.1.2.1.25.4.2.1.2.624 = STRING: "svchost.exe"
iso.3.6.1.2.1.25.4.2.1.2.644 = STRING: "LLSSRV.EXE"
iso.3.6.1.2.1.25.4.2.1.2.684 = STRING: "sqlservr.exe"
iso.3.6.1.2.1.25.4.2.1.2.760 = STRING: "regsvc.exe"
iso.3.6.1.2.1.25.4.2.1.2.792 = STRING: "mstask.exe"
iso.3.6.1.2.1.25.4.2.1.2.820 = STRING: "snmp.exe"
iso.3.6.1.2.1.25.4.2.1.2.856 = STRING: "vmtoolsd.exe"
iso.3.6.1.2.1.25.4.2.1.2.936 = STRING: "vmtoolsd.exe"
iso.3.6.1.2.1.25.4.2.1.2.968 = STRING: "winmgmt.exe"
iso.3.6.1.2.1.25.4.2.1.2.980 = STRING: "winvnc4.exe"
iso.3.6.1.2.1.25.4.2.1.2.992 = STRING: "svchost.exe"
iso.3.6.1.2.1.25.4.2.1.2.1028 = STRING: "mssearch.exe"
iso.3.6.1.2.1.25.4.2.1.2.1056 = STRING: "NTVDM.EXE"
iso.3.6.1.2.1.25.4.2.1.2.1232 = STRING: "dfssvc.exe"
iso.3.6.1.2.1.25.4.2.1.2.1352 = STRING: "QTIOQ3.exe"
iso.3.6.1.2.1.25.4.2.1.2.1496 = STRING: "sqlagent.exe"
iso.3.6.1.2.1.25.4.2.1.2.1548 = STRING: "sqlmangr.exe"
iso.3.6.1.2.1.25.4.2.1.2.1584 = STRING: "svchost.exe"
iso.3.6.1.2.1.25.4.2.1.2.1668 = STRING: "inetinfo.exe"
iso.3.6.1.2.1.25.4.2.1.2.1672 = STRING: "dllhost.exe"
iso.3.6.1.2.1.25.4.2.1.2.1708 = STRING: "CMD.EXE"
iso.3.6.1.2.1.25.4.2.1.2.1752 = STRING: "mdm.exe"
iso.3.6.1.2.1.25.4.2.1.2.1792 = STRING: "dllhost.exe"
```

Enumerating open TCP ports
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.227 1.3.6.1.2.1.6.13.1.3
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.21.0.0.0.0.2080 = INTEGER: 21
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.25.0.0.0.0.10388 = INTEGER: 25
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.80.0.0.0.0.2048 = INTEGER: 80
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.135.0.0.0.0.34839 = INTEGER: 135
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.443.0.0.0.0.2224 = INTEGER: 443
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.445.0.0.0.0.2064 = INTEGER: 445
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.1025.0.0.0.0.10280 = INTEGER: 1025
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.1026.0.0.0.0.59632 = INTEGER: 1026
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.1030.0.0.0.0.59482 = INTEGER: 1030
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.1434.0.0.0.0.26817 = INTEGER: 1434
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.1441.0.0.0.0.10348 = INTEGER: 1441
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.3372.0.0.0.0.26637 = INTEGER: 3372
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.5800.0.0.0.0.43138 = INTEGER: 5800
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.5900.0.0.0.0.59610 = INTEGER: 5900
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.6532.0.0.0.0.18638 = INTEGER: 6532
iso.3.6.1.2.1.6.13.1.3.10.11.1.227.139.0.0.0.0.59604 = INTEGER: 139
iso.3.6.1.2.1.6.13.1.3.10.11.1.227.1441.192.168.119.202.443 = INTEGER: 1441
iso.3.6.1.2.1.6.13.1.3.10.11.1.227.27900.0.0.0.0.18578 = INTEGER: 27900
iso.3.6.1.2.1.6.13.1.3.127.0.0.1.27900.0.0.0.0.10456 = INTEGER: 27900
```

Enumerating Installed Software
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/7_activeGathering$ snmpwalk -c public -v1 10.11.1.227 1.3.6.1.2.1.25.6.3.1.2
iso.3.6.1.2.1.25.6.3.1.2.1 = STRING: "Windows 2000 Hotfix (SP4) KB810217"
iso.3.6.1.2.1.25.6.3.1.2.2 = STRING: "Windows 2000 Hotfix (SP4) KB817606"
iso.3.6.1.2.1.25.6.3.1.2.3 = STRING: "Windows 2000 Hotfix - KB819696"
iso.3.6.1.2.1.25.6.3.1.2.4 = STRING: "Windows 2000 Hotfix - KB823182"
iso.3.6.1.2.1.25.6.3.1.2.5 = STRING: "Windows 2000 Hotfix - KB823559"
iso.3.6.1.2.1.25.6.3.1.2.6 = STRING: "Windows 2000 Hotfix - KB824105"
iso.3.6.1.2.1.25.6.3.1.2.7 = STRING: "Windows 2000 Hotfix - KB824151"
iso.3.6.1.2.1.25.6.3.1.2.8 = STRING: "Windows 2000 Hotfix - KB826232"
iso.3.6.1.2.1.25.6.3.1.2.9 = STRING: "Windows 2000 Hotfix - KB828035"
iso.3.6.1.2.1.25.6.3.1.2.10 = STRING: "Windows 2000 Hotfix - KB828741"
iso.3.6.1.2.1.25.6.3.1.2.11 = STRING: "Windows 2000 Hotfix - KB828749"
iso.3.6.1.2.1.25.6.3.1.2.12 = STRING: "Windows 2000 Hotfix - KB835732"
iso.3.6.1.2.1.25.6.3.1.2.13 = STRING: "Windows 2000 Hotfix - KB837001"
iso.3.6.1.2.1.25.6.3.1.2.14 = STRING: "Windows 2000 Hotfix - KB839643"
iso.3.6.1.2.1.25.6.3.1.2.15 = STRING: "Windows 2000 Hotfix - KB839645"
iso.3.6.1.2.1.25.6.3.1.2.16 = STRING: "Windows 2000 Hotfix - KB840987"
iso.3.6.1.2.1.25.6.3.1.2.17 = STRING: "Windows 2000 Hotfix - KB841356"
iso.3.6.1.2.1.25.6.3.1.2.18 = STRING: "Windows 2000 Hotfix - KB841533"
iso.3.6.1.2.1.25.6.3.1.2.19 = STRING: "Windows 2000 Hotfix - KB841872"
iso.3.6.1.2.1.25.6.3.1.2.20 = STRING: "Windows 2000 Hotfix - KB841873"
iso.3.6.1.2.1.25.6.3.1.2.21 = STRING: "Windows 2000 Hotfix - KB842526"
iso.3.6.1.2.1.25.6.3.1.2.22 = STRING: "Windows 2000 Hotfix - KB842773"
iso.3.6.1.2.1.25.6.3.1.2.23 = STRING: "Microsoft Data Access Components KB870669"
iso.3.6.1.2.1.25.6.3.1.2.24 = STRING: "Windows 2000 Hotfix - KB871250"
iso.3.6.1.2.1.25.6.3.1.2.25 = STRING: "Windows 2000 Hotfix - KB873333"
iso.3.6.1.2.1.25.6.3.1.2.26 = STRING: "Windows 2000 Hotfix - KB873339"
iso.3.6.1.2.1.25.6.3.1.2.27 = STRING: "Windows 2000 Hotfix - KB883939"
iso.3.6.1.2.1.25.6.3.1.2.28 = STRING: "Windows 2000 Hotfix - KB885250"
iso.3.6.1.2.1.25.6.3.1.2.29 = STRING: "Windows 2000 Hotfix - KB885834"
iso.3.6.1.2.1.25.6.3.1.2.30 = STRING: "Windows 2000 Hotfix - KB885835"
iso.3.6.1.2.1.25.6.3.1.2.31 = STRING: "Windows 2000 Hotfix - KB885836"
iso.3.6.1.2.1.25.6.3.1.2.32 = STRING: "Windows 2000 Hotfix - KB888113"
iso.3.6.1.2.1.25.6.3.1.2.33 = STRING: "Windows 2000 Hotfix - KB890046"
iso.3.6.1.2.1.25.6.3.1.2.34 = STRING: "Windows 2000 Hotfix - KB890859"
iso.3.6.1.2.1.25.6.3.1.2.35 = STRING: "Windows 2000 Hotfix - KB891781"
iso.3.6.1.2.1.25.6.3.1.2.36 = STRING: "Windows 2000 Hotfix - KB893066"
iso.3.6.1.2.1.25.6.3.1.2.37 = STRING: "Windows 2000 Hotfix - KB893086"
iso.3.6.1.2.1.25.6.3.1.2.38 = STRING: "Windows Installer 3.1 (KB893803)"
iso.3.6.1.2.1.25.6.3.1.2.39 = STRING: "Windows 2000 Hotfix - KB894320"
iso.3.6.1.2.1.25.6.3.1.2.40 = STRING: "Windows 2000 Hotfix - KB896358"
iso.3.6.1.2.1.25.6.3.1.2.41 = STRING: "Windows 2000 Hotfix - KB896422"
iso.3.6.1.2.1.25.6.3.1.2.42 = STRING: "Windows 2000 Hotfix - KB897715"
iso.3.6.1.2.1.25.6.3.1.2.43 = STRING: "Microsoft SQL Server 2000"
iso.3.6.1.2.1.25.6.3.1.2.44 = STRING: "Windows 2000 Hotfix (Pre-SP4) [See q323172 for more information]"
iso.3.6.1.2.1.25.6.3.1.2.45 = STRING: "Windows 2000 Hotfix (Pre-SP4) [See Q326830 for more information]"
iso.3.6.1.2.1.25.6.3.1.2.46 = STRING: "Windows 2000 Hotfix (Pre-SP4) [See Q326886 for more information]"
iso.3.6.1.2.1.25.6.3.1.2.47 = STRING: "Windows 2000 Hotfix (Pre-SP4) [See Q329115 for more information]"
iso.3.6.1.2.1.25.6.3.1.2.48 = STRING: "Windows 2000 Hotfix (Pre-SP4) Q329170"
iso.3.6.1.2.1.25.6.3.1.2.49 = STRING: "Windows 2000 Hotfix (SP4) Q329553"
iso.3.6.1.2.1.25.6.3.1.2.50 = STRING: "Windows 2000 Hotfix (Pre-SP4) [See Q329834 for more information]"
iso.3.6.1.2.1.25.6.3.1.2.51 = STRING: "Windows 2000 Hotfix (Pre-SP4) Q810833"
iso.3.6.1.2.1.25.6.3.1.2.52 = STRING: "Windows 2000 Hotfix (SP4) Q811114"
iso.3.6.1.2.1.25.6.3.1.2.53 = STRING: "Windows 2000 Hotfix (SP4) Q814033"
iso.3.6.1.2.1.25.6.3.1.2.54 = STRING: "Windows Media Player Hotfix [See Q828026 for more information]"
iso.3.6.1.2.1.25.6.3.1.2.55 = STRING: "VNC Free Edition 4.1.1"
iso.3.6.1.2.1.25.6.3.1.2.56 = STRING: "WinRAR archiver"
iso.3.6.1.2.1.25.6.3.1.2.57 = STRING: "Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.4148"
iso.3.6.1.2.1.25.6.3.1.2.58 = STRING: "ActiveState ActivePython 2.4.3"
iso.3.6.1.2.1.25.6.3.1.2.59 = STRING: "WebFldrs"
iso.3.6.1.2.1.25.6.3.1.2.60 = STRING: "VMware Tools"
```





id: bbce4e0913ad445eb145ee82ae861755
parent_id: bd7fb872bff44adabe0f55d8792e29e3
created_time: 2020-09-18T21:33:49.627Z
updated_time: 2020-09-20T08:47:04.706Z
is_conflict: 0
latitude: 0.00000000
longitude: 0.00000000
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2020-09-18T21:33:49.627Z
user_updated_time: 2020-09-20T08:47:04.706Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
type_: 1