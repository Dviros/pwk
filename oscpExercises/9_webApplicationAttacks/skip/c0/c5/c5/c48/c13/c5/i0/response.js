var res = {'data':'HTTP/1.1 200 Partial Content\x0aDate: Sun, 20 Sep 2020 15:00:03 GMT\x0aServer: Apache/2.4.29 (Ubuntu)\x0aLast-Modified: Fri, 22 Sep 2017 20:10:48 GMT\x0aETag: \x2215c36-559ccce022200-gzip\x22\x0aAccept-Ranges: bytes\x0aVary: Accept-Encoding\x0aContent-Encoding: gzip\x0aContent-Range: bytes 0-28041/28042\x0aContent-Length: 28042\x0aKeep-Alive: timeout=5, max=39\x0aConnection: Keep-Alive\x0aContent-Type: application/javascript\x0a\x0avar MXI_DEBUG=!1;!function(a,b){\x22use strict\x22;function c(a,b){for(var c,d=[],f=0;f\x3ca.length;++f){if(c=g[a[f]]||e(a[f]),!c)throw\x22module definition dependecy not found: \x22+a[f];d.push(c)}b.apply(null,d)}function d(a,d,e){if(\x22string\x22!=typeof a)throw\x22invalid module definition, module id must be defined and be a string\x22;if(d===b)throw\x22invalid module definition, dependencies must be specified\x22;if(e===b)throw\x22invalid module definition, definition function must be specified\x22;c(d,function(){g[a]=e.apply(null,arguments)})}function e(b){for(var c=a,d=b.split(/[.\x5c/]/),e=0;e\x3cd.length;++e){if(!c[d[e]])return;c=c[d[e]]}return c}function f(c){for(var d=0;d\x3cc.length;d++){for(var e=a,f=c[d],h=f.split(/[.\x5c/]/),i=0;i\x3ch.length-1;++i)e[h[i]]===b&&(e[h[i]]={}),e=e[h[i]];e[h[h.length-1]]=g[f]}}var g={};d(\x22moxie/core/utils/Basic\x22,[],function(){var a=function(a){var b;return a===b?\x22undefined\x22:null===a?\x22null\x22:a.nodeType?\x22node\x22:{}.toString.call(a).match(/\x5cs([a-z|A-Z]+)/)[1].toLowerCase()},b=function(d){var e;return c(arguments,function(f,h){h\x3e0&&c(f,function(c,f){c!==e&&(a(d[f])===a(c)&&~g(a(c),[\x22array\x22,\x22object\x22])?b(d[f],c):d[f]=c)})}),d},c=function(b,c){var d,e,f;if(b)if(\x22number\x22===a(b.length)){for(f=0,d=b.length;f\x3cd;f++)if(c(b[f],f)===!1)return}else if(\x22object\x22===a(b))for(e in b)if(b.hasOwnProperty(e)&&c(b[e],e)===!1)return},d=function(b){var c;if(!b||\x22object\x22!==a(b))return!0;for(c in b)return!1;return!0},e=function(b,c){function d(e){\x22function\x22===a(b[e])&&b[e](function(a){++e\x3cf&&!a?d(e):c(a)})}var e=0,f=b.length;\x22function\x22!==a(c)&&(c=function(){}),b&&b.length||c(),d(e)},f=function(a,b){var d=0,e=a.length,f=new Array(e);c(a,function(a,c){a(function(a){if(a)return b(a);var g=[].slice.call(arguments);g.shift(),f[c]=g,d++,d===e&&(f.unshift(null),b.apply(this,f))})})},g=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,d=b.length;c\x3cd;c++)if(b[c]===a)return c}return-1},h=function(b,c){var d=[];\x22array\x22!==a(b)&&(b=[b]),\x22array\x22!==a(c)&&(c=[c]);for(var e in b)g(b[e],c)===-1&&d.push(b[e]);return!!d.length&&d},i=function(a,b){var d=[];return c(a,function(a){g(a,b)!==-1&&d.push(a)}),d.length?d:null},j=function(a){var b,c=[];for(b=0;b\x3ca.length;b++)c[b]=a[b];return c},k=function(){var a=0;return function(b){var c,d=(new Date).getTime().toString(32);for(c=0;c\x3c5;c++)d+=Math.floor(65535*Math.random()).toString(32);return(b||\x22o_\x22)+d+(a++).toString(32)}}(),l=function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\x5cs*/,\x22\x22).replace(/\x5cs*$/,\x22\x22):a},m=function(a){if(\x22string\x22!=typeof a)return a;var b,c={t:1099511627776,g:1073741824,m:1048576,k:1024};return a=/^([0-9\x5c.]+)([tmgk]?)$/.exec(a.toLowerCase().replace(/[^0-9\x5c.tmkg]/g,\x22\x22)),b=a[2],a=+a[1],c.hasOwnProperty(b)&&(a*=c[b]),Math.floor(a)},n=function(b){var c=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=c.shift();return\x22undefined\x22!==a(b)?b:\x22\x22})};return{guid:k,typeOf:a,extend:b,each:c,isEmptyObj:d,inSeries:e,inParallel:f,inArray:g,arrayDiff:h,arrayIntersect:i,toArray:j,trim:l,sprintf:n,parseSizeStr:m}}),d(\x22moxie/core/utils/Env\x22,[\x22moxie/core/utils/Basic\x22],function(a){function b(a,b,c){var d=0,e=0,f=0,g={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,\x22#\x22:-2,p:1,pl:1},h=function(a){return a=(\x22\x22+a).replace(/[_\x5c-+]/g,\x22.\x22),a=a.replace(/([^.\x5cd]+)/g,\x22.$1.\x22).replace(/\x5c.{2,}/g,\x22.\x22),a.length?a.split(\x22.\x22):[-8]},i=function(a){return a?isNaN(a)?g[a]||-7:parseInt(a,10):0};for(a=h(a),b=h(b),e=Math.max(a.length,b.length),d=0;d\x3ce;d++)if(a[d]!=b[d]){if(a[d]=i(a[d]),b[d]=i(b[d]),a[d]\x3cb[d]){f=-1;break}if(a[d]\x3eb[d]){f=1;break}}if(!c)return f;switch(c){case\x22\x3e\x22:case\x22gt\x22:return f\x3e0;case\x22\x3e=\x22:case\x22ge\x22:return f\x3e=0;case\x22\x3c=\x22:case\x22le\x22:return f\x3c=0;case\x22==\x22:case\x22=\x22:case\x22eq\x22:return 0===f;case\x22\x3c\x3e\x22:case\x22!=\x22:case\x22ne\x22:return 0!==f;case\x22\x22:case\x22\x3c\x22:case\x22lt\x22:return f\x3c0;default:return null}}var c=function(a){var b=\x22\x22,c=\x22?\x22,d=\x22function\x22,e=\x22undefined\x22,f=\x22object\x22,g=\x22name\x22,h=\x22version\x22,i={has:function(a,b){return b.toLowerCase().indexOf(a.toLowerCase())!==-1},lowerize:function(a){return a.toLowerCase()}},j={rgx:function(){for(var b,c,g,h,i,j,k,l=0,m=arguments;l\x3cm.length;l+=2){var n=m[l],o=m[l+1];if(typeof b===e){b={};for(h in o)i=o[h],typeof i===f?b[i[0]]=a:b[i]=a}for(c=g=0;c\x3cn.length;c++)if(j=n[c].exec(this.getUA())){for(h=0;h\x3co.length;h++)k=j[++g],i=o[h],typeof i===f&&i.length\x3e0?2==i.length?typeof i[1]==d?b[i[0]]=i[1].call(this,k):b[i[0]]=i[1]:3==i.length?typeof i[1]!==d||i[1].exec&&i[1].test?b[i[0]]=k?k.replace(i[1],i[2]):a:b[i[0]]=k?i[1].call(this,k,i[2]):a:4==i.length&&(b[i[0]]=k?i[3].call(this,k.replace(i[1],i[2])):a):b[i]=k?k:a;break}if(j)break}return b},str:function(b,d){for(var e in d)if(typeof d[e]===f&&d[e].length\x3e0){for(var g=0;g\x3cd[e].length;g++)if(i.has(d[e][g],b))return e===c?a:e}else if(i.has(d[e],b))return e===c?a:e;return b}},k={browser:{oldsafari:{major:{1:[\x22/8\x22,\x22/1\x22,\x22/3\x22],2:\x22/4\x22,\x22?\x22:\x22/\x22},version:{\x221.0\x22:\x22/8\x22,1.2:\x22/1\x22,1.3:\x22/3\x22,\x222.0\x22:\x22/412\x22,\x222.0.2\x22:\x22/416\x22,\x222.0.3\x22:\x22/417\x22,\x222.0.4\x22:\x22/419\x22,\x22?\x22:\x22/\x22}}},device:{sprint:{model:{\x22Evo Shift 4G\x22:\x227373KT\x22},vendor:{HTC:\x22APA\x22,Sprint:\x22Sprint\x22}}},os:{windows:{version:{ME:\x224.90\x22,\x22NT 3.11\x22:\x22NT3.51\x22,\x22NT 4.0\x22:\x22NT4.0\x22,2000:\x22NT 5.0\x22,XP:[\x22NT 5.1\x22,\x22NT 5.2\x22],Vista:\x22NT 6.0\x22,7:\x22NT 6.1\x22,8:\x22NT 6.2\x22,8.1:\x22NT 6.3\x22,RT:\x22ARM\x22}}}},l={browser:[[/(opera\x5csmini)\x5c/([\x5cw\x5c.-]+)/i,/(opera\x5cs[mobiletab]+).+version\x5c/([\x5cw\x5c.-]+)/i,/(opera).+version\x5c/([\x5cw\x5c.]+)/i,/(opera)[\x5c/\x5cs]+([\x5cw\x5c.]+)/i],[g,h],[/\x5cs(opr)\x5c/([\x5cw\x5c.]+)/i],[[g,\x22Opera\x22],h],[/(kindle)\x5c/([\x5cw\x5c.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\x5c/\x5cs]?([\x5cw\x5c.]+)*/i,/(avant\x5cs|iemobile|slim|baidu)(?:browser)?[\x5c/\x5cs]?([\x5cw\x5c.]*)/i,/(?:ms|\x5c()(ie)\x5cs([\x5cw\x5c.]+)/i,/(rekonq)\x5c/([\x5cw\x5c.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\x5c/([\x5cw\x5c.-]+)/i],[g,h],[/(trident).+rv[:\x5cs]([\x5cw\x5c.]+).+like\x5csgecko/i],[[g,\x22IE\x22],h],[/(edge)\x5c/((\x5cd+)?[\x5cw\x5c.]+)/i],[g,h],[/(yabrowser)\x5c/([\x5cw\x5c.]+)/i],[[g,\x22Yandex\x22],h],[/(comodo_dragon)\x5c/([\x5cw\x5c.]+)/i],[[g,/_/g,\x22 \x22],h],[/(chrome|omniweb|arora|[tizenoka]{5}\x5cs?browser)\x5c/v?([\x5cw\x5c.]+)/i,/(uc\x5cs?browser|qqbrowser)[\x5c/\x5cs]?([\x5cw\x5c.]+)/i],[g,h],[/(dolfin)\x5c/([\x5cw\x5c.]+)/i],[[g,\x22Dolphin\x22],h],[/((?:android.+)crmo|crios)\x5c/([\x5cw\x5c.]+)/i],[[g,\x22Chrome\x22],h],[/XiaoMi\x5c/MiuiBrowser\x5c/([\x5cw\x5c.]+)/i],[h,[g,\x22MIUI Browser\x22]],[/android.+version\x5c/([\x5cw\x5c.]+)\x5cs+(?:mobile\x5cs?safari|safari)/i],[h,[g,\x22Android Browser\x22]],[/FBAV\x5c/([\x5cw\x5c.]+);/i],[h,[g,\x22Facebook\x22]],[/version\x5c/([\x5cw\x5c.]+).+?mobile\x5c/\x5cw+\x5cs(safari)/i],[h,[g,\x22Mobile Safari\x22]],[/version\x5c/([\x5cw\x5c.]+).+?(mobile\x5cs?safari|safari)/i],[h,g],[/webkit.+?(mobile\x5cs?safari|safari)(\x5c/[\x5cw\x5c.]+)/i],[g,[h,j.str,k.browser.oldsafari.version]],[/(konqueror)\x5c/([\x5cw\x5c.]+)/i,/(webkit|khtml)\x5c/([\x5cw\x5c.]+)/i],[g,h],[/(navigator|netscape)\x5c/([\x5cw\x5c.-]+)/i],[[g,\x22Netscape\x22],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\x5csbrowser|minimo|conkeror)[\x5c/\x5cs]?([\x5cw\x5c.\x5c+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\x5c/([\x5cw\x5c.-]+)/i,/(mozilla)\x5c/([\x5cw\x5c.]+).+rv\x5c:.+gecko\x5c/\x5cd+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\x5c/\x5cs]?([\x5cw\x5c.]+)/i,/(links)\x5cs\x5c(([\x5cw\x5c.]+)/i,/(gobrowser)\x5c/?([\x5cw\x5c.]+)*/i,/(ice\x5cs?browser)\x5c/v?([\x5cw\x5c._]+)/i,/(mosaic)[\x5c/\x5cs]([\x5cw\x5c.]+)/i],[g,h]],engine:[[/windows.+\x5csedge\x5c/([\x5cw\x5c.]+)/i],[h,[g,\x22EdgeHTML\x22]],[/(presto)\x5c/([\x5cw\x5c.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\x5c/([\x5cw\x5c.]+)/i,/(khtml|tasman|links)[\x5c/\x5cs]\x5c(?([\x5cw\x5c.]+)/i,/(icab)[\x5c/\x5cs]([23]\x5c.[\x5cd\x5c.]+)/i],[g,h],[/rv\x5c:([\x5cw\x5c.]+).*(gecko)/i],[h,g]],os:[[/microsoft\x5cs(windows)\x5cs(vista|xp)/i],[g,h],[/(windows)\x5csnt\x5cs6\x5c.2;\x5cs(arm)/i,/(windows\x5csphone(?:\x5csos)*|windows\x5csmobile|windows)[\x5cs\x5c/]?([ntce\x5cd\x5c.\x5cs]+\x5cw)/i],[g,[h,j.str,k.os.windows.version]],[/(win(?=3|9|n)|win\x5cs9x\x5cs)([nt\x5cd\x5c.]+)/i],[[g,\x22Windows\x22],[h,j.str,k.os.windows.version]],[/\x5c((bb)(10);/i],[[g,\x22BlackBerry\x22],h],[/(blackberry)\x5cw*\x5c/?([\x5cw\x5c.]+)*/i,/(tizen)[\x5c/\x5cs]([\x5cw\x5c.]+)/i,/(android|webos|palm\x5cos|qnx|bada|rim\x5cstablet\x5csos|meego|contiki)[\x5c/\x5cs-]?([\x5cw\x5c.]+)*/i,/linux;.+(sailfish);/i],[g,h],[/(symbian\x5cs?os|symbos|s60(?=;))[\x5c/\x5cs-]?([\x5cw\x5c.]+)*/i],[[g,\x22Symbian\x22],h],[/\x5c((series40);/i],[g],[/mozilla.+\x5c(mobile;.+gecko.+firefox/i],[[g,\x22Firefox OS\x22],h],[/(nintendo|playstation)\x5cs([wids3portablevu]+)/i,/(mint)[\x5c/\x5cs\x5c(]?(\x5cw+)*/i,/(mageia|vectorlinux)[;\x5cs]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\x5c/\x5cs-]?([\x5cw\x5c.-]+)*/i,/(hurd|linux)\x5cs?([\x5cw\x5c.]+)*/i,/(gnu)\x5cs?([\x5cw\x5c.]+)*/i],[g,h],[/(cros)\x5cs[\x5cw]+\x5cs([\x5cw\x5c.]+\x5cw)/i],[[g,\x22Chromium OS\x22],h],[/(sunos)\x5cs?([\x5cw\x5c.]+\x5cd)*/i],[[g,\x22Solaris\x22],h],[/\x5cs([frentopc-]{0,4}bsd|dragonfly)\x5cs?([\x5cw\x5c.]+)*/i],[g,h],[/(ip[honead]+)(?:.*os\x5cs*([\x5cw]+)*\x5cslike\x5csmac|;\x5csopera)/i],[[g,\x22iOS\x22],[h,/_/g,\x22.\x22]],[/(mac\x5csos\x5csx)\x5cs?([\x5cw\x5cs\x5c.]+\x5cw)*/i,/(macintosh|mac(?=_powerpc)\x5cs)/i],[[g,\x22Mac OS\x22],[h,/_/g,\x22.\x22]],[/((?:open)?solaris)[\x5c/\x5cs-]?([\x5cw\x5c.]+)*/i,/(haiku)\x5cs(\x5cw+)/i,/(aix)\x5cs((\x5cd)(?=\x5c.|\x5c)|\x5cs)[\x5cw\x5c.]*)*/i,/(plan\x5cs9|minix|beos|os\x5c/2|amigaos|morphos|risc\x5csos|openvms)/i,/(unix)\x5cs?([\x5cw\x5c.]+)*/i],[g,h]]},m=function(a){var c=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:b);this.getBrowser=function(){return j.rgx.apply(this,l.browser)},this.getEngine=function(){return j.rgx.apply(this,l.engine)},this.getOS=function(){return j.rgx.apply(this,l.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return c},this.setUA=function(a){return c=a,this},this.setUA(c)};return m}(),d=function(){var b={define_property:function(){return!1}(),create_canvas:function(){var a=document.createElement(\x22canvas\x22);return!(!a.getContext||!a.getContext(\x222d\x22))}(),return_response_type:function(b){try{if(a.inArray(b,[\x22\x22,\x22text\x22,\x22document\x22])!==-1)return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;if(c.open(\x22get\x22,\x22/\x22),\x22responseType\x22in c)return c.responseType=b,c.responseType===b}}catch(d){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){b.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src=\x22data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==\x22},1),!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&(\x22IE\x22!==f.browser||f.version\x3e=9)},use_data_uri_of:function(a){return b.use_data_uri&&a\x3c33e3||b.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\x5c/(1.0|2.0|2.5|3.0))/))return!1;var a=document.createElement(\x22input\x22);return a.setAttribute(\x22type\x22,\x22file\x22),!a.disabled}};return function(c){var d=[].slice.call(arguments);return d.shift(),\x22function\x22===a.typeOf(b[c])?b[c].apply(this,d):!!b[c]}}(),e=(new c).getResult(),f={can:d,uaParser:c,browser:e.browser.name,version:e.browser.version,os:e.os.name,osVersion:e.os.version,verComp:b,global_event_dispatcher:\x22moxie.core.EventTarget.instance.dispatchEvent\x22};return f.OS=f.os,MXI_DEBUG&&(f.debug={runtime:!0,events:!1},f.log=function(){function b(a){d.appendChild(document.createTextNode(a+\x22\x5cn\x22))}var c=arguments[0];if(\x22string\x22===a.typeOf(c)&&(c=a.sprintf.apply(this,arguments)),window&&window.console&&window.console.log)window.console.log(c);else if(document){var d=document.getElementById(\x22moxie-console\x22);d||(d=document.createElement(\x22pre\x22),d.id=\x22moxie-console\x22,document.body.appendChild(d)),a.inArray(a.typeOf(c),[\x22object\x22,\x22array\x22])!==-1?b(c):d.appendChild(document.createTextNode(c+\x22\x5cn\x22))}}),f}),d(\x22moxie/core/I18n\x22,[\x22moxie/core/utils/Basic\x22],function(a){var b={};return{addI18n:function(c){return a.extend(b,c)},translate:function(a){return b[a]||a},_:function(a){return this.translate(a)},sprintf:function(b){var c=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=c.shift();return\x22undefined\x22!==a.typeOf(b)?b:\x22\x22})}}}),d(\x22moxie/core/utils/Mime\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/I18n\x22],function(a,b){var c=\x22application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe\x22,d={mimes:{},extensions:{},addMimeType:function(a){var b,c,d,e=a.split(/,/);for(b=0;b\x3ce.length;b+=2){for(d=e[b+1].split(/ /),c=0;c\x3cd.length;c++)this.mimes[d[c]]=e[b];this.extensions[e[b]]=d}},extList2mimes:function(b,c){var d,e,f,g,h=this,i=[];for(e=0;e\x3cb.length;e++)for(d=b[e].extensions.split(/\x5cs*,\x5cs*/),f=0;f\x3cd.length;f++){if(\x22*\x22===d[f])return[];if(g=h.mimes[d[f]],g&&a.inArray(g,i)===-1&&i.push(g),c&&/^\x5cw+$/.test(d[f]))i.push(\x22.\x22+d[f]);else if(!g)return[]}return i},mimes2exts:function(b){var c=this,d=[];return a.each(b,function(b){if(\x22*\x22===b)return d=[],!1;var e=b.match(/^(\x5cw+)\x5c/(\x5c*|\x5cw+)$/);e&&(\x22*\x22===e[2]?a.each(c.extensions,function(a,b){new RegExp(\x22^\x22+e[1]+\x22/\x22).test(b)&&[].push.apply(d,c.extensions[b])}):c.extensions[b]&&[].push.apply(d,c.extensions[b]))}),d},mimes2extList:function(c){var d=[],e=[];return\x22string\x22===a.typeOf(c)&&(c=a.trim(c).split(/\x5cs*,\x5cs*/)),e=this.mimes2exts(c),d.push({title:b.translate(\x22Files\x22),extensions:e.length?e.join(\x22,\x22):\x22*\x22}),d.mimes=c,d},getFileExtension:function(a){var b=a&&a.match(/\x5c.([^.]+)$/);return b?b[1].toLowerCase():\x22\x22},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||\x22\x22}};return d.addMimeType(c),d}),d(\x22moxie/core/utils/Dom\x22,[\x22moxie/core/utils/Env\x22],function(a){var b=function(a){return\x22string\x22!=typeof a?a:document.getElementById(a)},c=function(a,b){if(!a.className)return!1;var c=new RegExp(\x22(^|\x5c\x5cs+)\x22+b+\x22(\x5c\x5cs+|$)\x22);return c.test(a.className)},d=function(a,b){c(a,b)||(a.className=a.className?a.className.replace(/\x5cs+$/,\x22\x22)+\x22 \x22+b:b)},e=function(a,b){if(a.className){var c=new RegExp(\x22(^|\x5c\x5cs+)\x22+b+\x22(\x5c\x5cs+|$)\x22);a.className=a.className.replace(c,function(a,b,c){return\x22 \x22===b&&\x22 \x22===c?\x22 \x22:\x22\x22})}},f=function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null)[b]:void 0},g=function(b,c){function d(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b=\x22CSS1Compat\x22===j.compatMode?j.documentElement:j.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var e,f,g,h=0,i=0,j=document;if(b=b,c=c||j.body,b&&b.getBoundingClientRect&&\x22IE\x22===a.browser&&(!j.documentMode||j.documentMode\x3c8))return f=d(b),g=d(c),{x:f.x-g.x,y:f.y-g.y};for(e=b;e&&e!=c&&e.nodeType;)h+=e.offsetLeft||0,i+=e.offsetTop||0,e=e.offsetParent;for(e=b.parentNode;e&&e!=c&&e.nodeType;)h-=e.scrollLeft||0,i-=e.scrollTop||0,e=e.parentNode;return{x:h,y:i}},h=function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}};return{get:b,hasClass:c,addClass:d,removeClass:e,getStyle:f,getPos:g,getSize:h}}),d(\x22moxie/core/Exceptions\x22,[\x22moxie/core/utils/Basic\x22],function(a){function b(a,b){var c;for(c in a)if(a[c]===b)return c;return null}return{RuntimeError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+\x22: RuntimeError \x22+this.code}var d={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return a.extend(c,d),c.prototype=Error.prototype,c}(),OperationNotAllowedException:function(){function b(a){this.code=a,this.name=\x22OperationNotAllowedException\x22}return a.extend(b,{NOT_ALLOWED_ERR:1}),b.prototype=Error.prototype,b}(),ImageError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+\x22: ImageError \x22+this.code}var d={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return a.extend(c,d),c.prototype=Error.prototype,c}(),FileException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+\x22: FileException \x22+this.code}var d={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return a.extend(c,d),c.prototype=Error.prototype,c}(),DOMException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+\x22: DOMException \x22+this.code}var d={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return a.extend(c,d),c.prototype=Error.prototype,c}(),EventException:function(){function b(a){this.code=a,this.name=\x22EventException\x22}return a.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0}),b.prototype=Error.prototype,b}()}}),d(\x22moxie/core/EventTarget\x22,[\x22moxie/core/utils/Env\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Basic\x22],function(a,b,c){function d(){var d={};c.extend(this,{uid:null,init:function(){this.uid||(this.uid=c.guid(\x22uid_\x22))},addEventListener:function(a,b,e,f){var g,h=this;return this.hasOwnProperty(\x22uid\x22)||(this.uid=c.guid(\x22uid_\x22)),a=c.trim(a),/\x5cs/.test(a)?void c.each(a.split(/\x5cs+/),function(a){h.addEventListener(a,b,e,f)}):(a=a.toLowerCase(),e=parseInt(e,10)||0,g=d[this.uid]&&d[this.uid][a]||[],g.push({fn:b,priority:e,scope:f||this}),d[this.uid]||(d[this.uid]={}),void(d[this.uid][a]=g))},hasEventListener:function(a){var b=a?d[this.uid]&&d[this.uid][a]:d[this.uid];return!!b&&b},removeEventListener:function(a,b){a=a.toLowerCase();var e,f=d[this.uid]&&d[this.uid][a];if(f){if(b){for(e=f.length-1;e\x3e=0;e--)if(f[e].fn===b){f.splice(e,1);break}}else f=[];f.length||(delete d[this.uid][a],c.isEmptyObj(d[this.uid])&&delete d[this.uid])}},removeAllEventListeners:function(){d[this.uid]&&delete d[this.uid]},dispatchEvent:function(e){var f,g,h,i,j,k={},l=!0;if(\x22string\x22!==c.typeOf(e)){if(i=e,\x22string\x22!==c.typeOf(i.type))throw new b.EventException(b.EventException.UNSPECIFIED_EVENT_TYPE_ERR);e=i.type,i.total!==j&&i.loaded!==j&&(k.total=i.total,k.loaded=i.loaded),k.async=i.async||!1}if(e.indexOf(\x22::\x22)!==-1?!function(a){f=a[0],e=a[1]}(e.split(\x22::\x22)):f=this.uid,e=e.toLowerCase(),g=d[f]&&d[f][e]){g.sort(function(a,b){return b.priority-a.priority}),h=[].slice.call(arguments),h.shift(),k.type=e,h.unshift(k),MXI_DEBUG&&a.debug.events&&a.log(\x22Event \x27%s\x27 fired on %u\x22,k.type,f);var m=[];c.each(g,function(a){h[0].target=a.scope,k.async?m.push(function(b){setTimeout(function(){b(a.fn.apply(a.scope,h)===!1)},1)}):m.push(function(b){b(a.fn.apply(a.scope,h)===!1)})}),m.length&&c.inSeries(m,function(a){l=!a})}return l},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(a){var b=this;this.bind(a.join(\x22 \x22),function(a){var b=\x22on\x22+a.type.toLowerCase();\x22function\x22===c.typeOf(this[b])&&this[b].apply(this,arguments)}),c.each(a,function(a){a=\x22on\x22+a.toLowerCase(a),\x22undefined\x22===c.typeOf(b[a])&&(b[a]=null)})}})}return d.instance=new d,d}),d(\x22moxie/runtime/Runtime\x22,[\x22moxie/core/utils/Env\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/EventTarget\x22],function(a,b,c,d){function e(d,f,h,i,j){var k,l=this,m=b.guid(f+\x22_\x22),n=j||\x22browser\x22;d=d||{},g[m]=this,h=b.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},h),d.preferred_caps&&(n=e.getMode(i,d.preferred_caps,n)),MXI_DEBUG&&a.debug.runtime&&a.log(\x22\x5ctdefault mode: %s\x22,n),k=function(){var a={};return{exec:function(b,c,d,e){if(k[c]&&(a[b]||(a[b]={context:this,instance:new k[c]}),a[b].instance[d]))return a[b].instance[d].apply(this,e)},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var c=this;b.each(a,function(a,d){\x22function\x22===b.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context),c.removeInstance(d)})}}}(),b.extend(this,{initialized:!1,uid:m,type:f,mode:e.getMode(i,d.required_caps,n),shimid:m+\x22_container\x22,clients:0,options:d,can:function(a,c){var d=arguments[2]||h;if(\x22string\x22===b.typeOf(a)&&\x22undefined\x22===b.typeOf(c)&&(a=e.parseCaps(a)),\x22object\x22===b.typeOf(a)){for(var f in a)if(!this.can(f,a[f],d))return!1;return!0}return\x22function\x22===b.typeOf(d[a])?d[a].call(this,c):c===d[a]},getShimContainer:function(){var a,d=c.get(this.shimid);return d||(a=this.options.container?c.get(this.options.container):document.body,d=document.createElement(\x22div\x22),d.id=this.shimid,d.className=\x22moxie-shim moxie-shim-\x22+this.type,b.extend(d.style,{position:\x22absolute\x22,top:\x220px\x22,left:\x220px\x22,width:\x221px\x22,height:\x221px\x22,overflow:\x22hidden\x22}),a.appendChild(d),a=null),d},getShim:function(){return k},shimExec:function(a,b){var c=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return l[a]&&l[a][b]?l[a][b].apply(this,c):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var a=c.get(this.shimid);a&&a.parentNode.removeChild(a),k&&k.removeAllInstances(),this.unbindAll(),delete g[this.uid],this.uid=null,m=l=k=a=null}}}),this.mode&&d.required_caps&&!this.can(d.required_caps)&&(this.mode=!1)}var f={},g={};return e.order=\x22html5,html4\x22,e.getRuntime=function(a){return!!g[a]&&g[a]},e.addConstructor=function(a,b){b.prototype=d.instance,f[a]=b},e.getConstructor=function(a){return f[a]||null},e.getInfo=function(a){var b=e.getRuntime(a);return b?{uid:b.uid,type:b.type,mode:b.mode,can:function(){return b.can.apply(b,arguments)}}:null},e.parseCaps=function(a){var c={};return\x22string\x22!==b.typeOf(a)?a||{}:(b.each(a.split(\x22,\x22),function(a){c[a]=!0}),c)},e.can=function(a,b){var c,d,f=e.getConstructor(a);return!!f&&(c=new f({required_caps:b}),d=c.mode,c.destroy(),!!d)},e.thatCan=function(a,b){var c=(b||e.order).split(/\x5cs*,\x5cs*/);for(var d in c)if(e.can(c[d],a))return c[d];return null},e.getMode=function(c,d,e){var f=null;if(\x22undefined\x22===b.typeOf(e)&&(e=\x22browser\x22),d&&!b.isEmptyObj(c)){if(b.each(d,function(d,e){if(c.hasOwnProperty(e)){var g=c[e](d);if(\x22string\x22==typeof g&&(g=[g]),f){if(!(f=b.arrayIntersect(f,g)))return MXI_DEBUG&&a.debug.runtime&&a.log(\x22\x5ct\x5ct%c: %v (conflicting mode requested: %s)\x22,e,d,g),f=!1}else f=g}MXI_DEBUG&&a.debug.runtime&&a.log(\x22\x5ct\x5ct%c: %v (compatible modes: %s)\x22,e,d,f)}),f)return b.inArray(e,f)!==-1?e:f[0];if(f===!1)return!1}return e},e.capTrue=function(){return!0},e.capFalse=function(){return!1},e.capTest=function(a){return function(){return!!a}},e}),d(\x22moxie/runtime/RuntimeClient\x22,[\x22moxie/core/utils/Env\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/runtime/Runtime\x22],function(a,b,c,d){return function(){var e;c.extend(this,{connectRuntime:function(f){function g(c){var h,j;return c.length?(h=c.shift().toLowerCase(),(j=d.getConstructor(h))?(MXI_DEBUG&&a.debug.runtime&&(a.log(\x22Trying runtime: %s\x22,h),a.log(f)),e=new j(f),e.bind(\x22Init\x22,function(){e.initialized=!0,MXI_DEBUG&&a.debug.runtime&&a.log(\x22Runtime \x27%s\x27 initialized\x22,e.type),setTimeout(function(){e.clients++,i.trigger(\x22RuntimeInit\x22,e)},1)}),e.bind(\x22Error\x22,function(){MXI_DEBUG&&a.debug.runtime&&a.log(\x22Runtime \x27%s\x27 failed to initialize\x22,e.type),e.destroy(),g(c)}),MXI_DEBUG&&a.debug.runtime&&a.log(\x22\x5ctselected mode: %s\x22,e.mode),e.mode?void e.init():void e.trigger(\x22Error\x22)):void g(c)):(i.trigger(\x22RuntimeError\x22,new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)),void(e=null))}var h,i=this;if(\x22string\x22===c.typeOf(f)?h=f:\x22string\x22===c.typeOf(f.ruid)&&(h=f.ruid),h){if(e=d.getRuntime(h))return e.clients++,e;throw new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)}g((f.runtime_order||d.order).split(/\x5cs*,\x5cs*/))},disconnectRuntime:function(){e&&--e.clients\x3c=0&&e.destroy(),e=null},getRuntime:function(){return e&&e.uid?e:e=null},exec:function(){return e?e.exec.apply(this,arguments):null}})}}),d(\x22moxie/file/FileInput\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Env\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/EventTarget\x22,\x22moxie/core/I18n\x22,\x22moxie/runtime/Runtime\x22,\x22moxie/runtime/RuntimeClient\x22],function(a,b,c,d,e,f,g,h,i){function j(f){MXI_DEBUG&&b.log(\x22Instantiating FileInput...\x22);var j,l,m,n=this;if(a.inArray(a.typeOf(f),[\x22string\x22,\x22node\x22])!==-1&&(f={browse_button:f}),l=d.get(f.browse_button),!l)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);m={accept:[{title:g.translate(\x22All Files\x22),extensions:\x22*\x22}],name:\x22file\x22,multiple:!1,required_caps:!1,container:l.parentNode||document.body},f=a.extend({},m,f),\x22string\x22==typeof f.required_caps&&(f.required_caps=h.parseCaps(f.required_caps)),\x22string\x22==typeof f.accept&&(f.accept=c.mimes2extList(f.accept)),j=d.get(f.container),j||(j=document.body),\x22static\x22===d.getStyle(j,\x22position\x22)&&(j.style.position=\x22relative\x22),j=l=null,i.call(n),a.extend(n,{uid:a.guid(\x22uid_\x22),ruid:null,shimid:null,files:null,init:function(){n.bind(\x22RuntimeInit\x22,function(b,c){n.ruid=c.uid,n.shimid=c.shimid,n.bind(\x22Ready\x22,function(){n.trigger(\x22Refresh\x22)},999),n.bind(\x22Refresh\x22,function(){var b,e,g,h;g=d.get(f.browse_button),h=d.get(c.shimid),g&&(b=d.getPos(g,d.get(f.container)),e=d.getSize(g),h&&a.extend(h.style,{top:b.y+\x22px\x22,left:b.x+\x22px\x22,width:e.w+\x22px\x22,height:e.h+\x22px\x22})),h=g=null}),c.exec.call(n,\x22FileInput\x22,\x22init\x22,f)}),n.connectRuntime(a.extend({},f,{required_caps:{select_file:!0}}))},disable:function(b){var c=this.getRuntime();c&&c.exec.call(this,\x22FileInput\x22,\x22disable\x22,\x22undefined\x22===a.typeOf(b)||b)},refresh:function(){n.trigger(\x22Refresh\x22)},destroy:function(){var b=this.getRuntime();b&&(b.exec.call(this,\x22FileInput\x22,\x22destroy\x22),this.disconnectRuntime()),\x22array\x22===a.typeOf(this.files)&&a.each(this.files,function(a){a.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(k)}var k=[\x22ready\x22,\x22change\x22,\x22cancel\x22,\x22mouseenter\x22,\x22mouseleave\x22,\x22mousedown\x22,\x22mouseup\x22];return j.prototype=f.instance,j}),d(\x22moxie/core/utils/Encode\x22,[],function(){var a=function(a){return unescape(encodeURIComponent(a))},b=function(a){return decodeURIComponent(escape(a))},c=function(a,c){if(\x22function\x22==typeof window.atob)return c?b(window.atob(a)):window.atob(a);var d,e,f,g,h,i,j,k,l=\x22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\x22,m=0,n=0,o=\x22\x22,p=[];if(!a)return a;a+=\x22\x22;do g=l.indexOf(a.charAt(m++)),h=l.indexOf(a.charAt(m++)),i=l.indexOf(a.charAt(m++)),j=l.indexOf(a.charAt(m++)),k=g\x3c\x3c18|h\x3c\x3c12|i\x3c\x3c6|j,d=k\x3e\x3e16&255,e=k\x3e\x3e8&255,f=255&k,64==i?p[n++]=String.fromCharCode(d):64==j?p[n++]=String.fromCharCode(d,e):p[n++]=String.fromCharCode(d,e,f);while(m\x3ca.length);return o=p.join(\x22\x22),c?b(o):o},d=function(b,c){if(c&&(b=a(b)),\x22function\x22==typeof window.btoa)return window.btoa(b);var d,e,f,g,h,i,j,k,l=\x22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\x22,m=0,n=0,o=\x22\x22,p=[];if(!b)return b;do d=b.charCodeAt(m++),e=b.charCodeAt(m++),f=b.charCodeAt(m++),k=d\x3c\x3c16|e\x3c\x3c8|f,g=k\x3e\x3e18&63,h=k\x3e\x3e12&63,i=k\x3e\x3e6&63,j=63&k,p[n++]=l.charAt(g)+l.charAt(h)+l.charAt(i)+l.charAt(j);while(m\x3cb.length);o=p.join(\x22\x22);var q=b.length%3;return(q?o.slice(0,q-3):o)+\x22===\x22.slice(q||3)};return{utf8_encode:a,utf8_decode:b,atob:c,btoa:d}}),d(\x22moxie/file/Blob\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/runtime/RuntimeClient\x22],function(a,b,c){function d(f,g){function h(b,c,f){var g,h=e[this.uid];return\x22string\x22===a.typeOf(h)&&h.length?(g=new d(null,{type:f,size:c-b}),g.detach(h.substr(b,g.size)),g):null}c.call(this),f&&this.connectRuntime(f),g?\x22string\x22===a.typeOf(g)&&(g={data:g}):g={},a.extend(this,{uid:g.uid||a.guid(\x22uid_\x22),ruid:f,size:g.size||0,type:g.type||\x22\x22,slice:function(a,b,c){return this.isDetached()?h.apply(this,arguments):this.getRuntime().exec.call(this,\x22Blob\x22,\x22slice\x22,this.getSource(),a,b,c)},getSource:function(){return e[this.uid]?e[this.uid]:null},detach:function(a){if(this.ruid&&(this.getRuntime().exec.call(this,\x22Blob\x22,\x22destroy\x22),this.disconnectRuntime(),this.ruid=null),a=a||\x22\x22,\x22data:\x22==a.substr(0,5)){var c=a.indexOf(\x22;base64,\x22);this.type=a.substring(5,c),a=b.atob(a.substring(c+8))}this.size=a.length,e[this.uid]=a},isDetached:function(){return!this.ruid&&\x22string\x22===a.typeOf(e[this.uid])},destroy:function(){this.detach(),delete e[this.uid]}}),g.data?this.detach(g.data):e[this.uid]=g}var e={};return d}),d(\x22moxie/file/File\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/file/Blob\x22],function(a,b,c){function d(d,e){e||(e={}),c.apply(this,arguments),this.type||(this.type=b.getFileMime(e.name));var f;if(e.name)f=e.name.replace(/\x5c\x5c/g,\x22/\x22),f=f.substr(f.lastIndexOf(\x22/\x22)+1);else if(this.type){var g=this.type.split(\x22/\x22)[0];f=a.guid((\x22\x22!==g?g:\x22file\x22)+\x22_\x22),b.extensions[this.type]&&(f+=\x22.\x22+b.extensions[this.type][0])}a.extend(this,{name:f||a.guid(\x22file_\x22),relativePath:\x22\x22,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString()})}return d.prototype=c.prototype,d}),d(\x22moxie/file/FileDrop\x22,[\x22moxie/core/I18n\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Env\x22,\x22moxie/file/File\x22,\x22moxie/runtime/RuntimeClient\x22,\x22moxie/core/EventTarget\x22,\x22moxie/core/utils/Mime\x22],function(a,b,c,d,e,f,g,h,i){function j(c){MXI_DEBUG&&e.log(\x22Instantiating FileDrop...\x22);var f,h=this;\x22string\x22==typeof c&&(c={drop_zone:c}),f={accept:[{title:a.translate(\x22All Files\x22),extensions:\x22*\x22}],required_caps:{drag_and_drop:!0}},c=\x22object\x22==typeof c?d.extend({},f,c):f,c.container=b.get(c.drop_zone)||document.body,\x22static\x22===b.getStyle(c.container,\x22position\x22)&&(c.container.style.position=\x22relative\x22),\x22string\x22==typeof c.accept&&(c.accept=i.mimes2extList(c.accept)),g.call(h),d.extend(h,{uid:d.guid(\x22uid_\x22),ruid:null,files:null,init:function(){h.bind(\x22RuntimeInit\x22,function(a,b){h.ruid=b.uid,b.exec.call(h,\x22FileDrop\x22,\x22init\x22,c),h.dispatchEvent(\x22ready\x22)}),h.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,\x22FileDrop\x22,\x22destroy\x22),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(k)}var k=[\x22ready\x22,\x22dragenter\x22,\x22dragleave\x22,\x22drop\x22,\x22error\x22];return j.prototype=h.instance,j}),d(\x22moxie/file/FileReader\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/EventTarget\x22,\x22moxie/file/Blob\x22,\x22moxie/runtime/RuntimeClient\x22],function(a,b,c,d,e,f){function g(){function d(a,d){if(this.trigger(\x22loadstart\x22),this.readyState===g.LOADING)return this.trigger(\x22error\x22,new c.DOMException(c.DOMException.INVALID_STATE_ERR)),void this.trigger(\x22loadend\x22);if(!(d instanceof e))return this.trigger(\x22error\x22,new c.DOMException(c.DOMException.NOT_FOUND_ERR)),void this.trigger(\x22loadend\x22);if(this.result=null,this.readyState=g.LOADING,d.isDetached()){var f=d.getSource();switch(a){case\x22readAsText\x22:case\x22readAsBinaryString\x22:this.result=f;break;case\x22readAsDataURL\x22:this.result=\x22data:\x22+d.type+\x22;base64,\x22+b.btoa(f)}this.readyState=g.DONE,this.trigger(\x22load\x22),this.trigger(\x22loadend\x22)}else this.connectRuntime(d.ruid),this.exec(\x22FileReader\x22,\x22read\x22,a,d);\x0a}f.call(this),a.extend(this,{uid:a.guid(\x22uid_\x22),readyState:g.EMPTY,result:null,error:null,readAsBinaryString:function(a){d.call(this,\x22readAsBinaryString\x22,a)},readAsDataURL:function(a){d.call(this,\x22readAsDataURL\x22,a)},readAsText:function(a){d.call(this,\x22readAsText\x22,a)},abort:function(){this.result=null,a.inArray(this.readyState,[g.EMPTY,g.DONE])===-1&&(this.readyState===g.LOADING&&(this.readyState=g.DONE),this.exec(\x22FileReader\x22,\x22abort\x22),this.trigger(\x22abort\x22),this.trigger(\x22loadend\x22))},destroy:function(){this.abort(),this.exec(\x22FileReader\x22,\x22destroy\x22),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(h),this.bind(\x22Error\x22,function(a,b){this.readyState=g.DONE,this.error=b},999),this.bind(\x22Load\x22,function(a){this.readyState=g.DONE},999)}var h=[\x22loadstart\x22,\x22progress\x22,\x22load\x22,\x22abort\x22,\x22error\x22,\x22loadend\x22];return g.EMPTY=0,g.LOADING=1,g.DONE=2,g.prototype=d.instance,g}),d(\x22moxie/core/utils/Url\x22,[],function(){var a=function(b,c){for(var d=[\x22source\x22,\x22scheme\x22,\x22authority\x22,\x22userInfo\x22,\x22user\x22,\x22pass\x22,\x22host\x22,\x22port\x22,\x22relative\x22,\x22path\x22,\x22directory\x22,\x22file\x22,\x22query\x22,\x22fragment\x22],e=d.length,f={http:80,https:443},g={},h=/^(?:([^:\x5c/?#]+):)?(?:\x5c/\x5c/()(?:(?:()(?:([^:@\x5c/]*):?([^:@\x5c/]*))?@)?([^:\x5c/?#]*)(?::(\x5cd*))?))?()(?:(()(?:(?:[^?#\x5c/]*\x5c/)*)()(?:[^?#]*))(?:\x5c\x5c?([^#]*))?(?:#(.*))?)/,i=h.exec(b||\x22\x22);e--;)i[e]&&(g[d[e]]=i[e]);if(!g.scheme){c&&\x22string\x22!=typeof c||(c=a(c||document.location.href)),g.scheme=c.scheme,g.host=c.host,g.port=c.port;var j=\x22\x22;/^[^\x5c/]/.test(g.path)&&(j=c.path,j=/\x5c/[^\x5c/]*\x5c.[^\x5c/]*$/.test(j)?j.replace(/\x5c/[^\x5c/]+$/,\x22/\x22):j.replace(/\x5c/?$/,\x22/\x22)),g.path=j+(g.path||\x22\x22)}return g.port||(g.port=f[g.scheme]||80),g.port=parseInt(g.port,10),g.path||(g.path=\x22/\x22),delete g.source,g},b=function(b){var c={http:80,https:443},d=\x22object\x22==typeof b?b:a(b);return d.scheme+\x22://\x22+d.host+(d.port!==c[d.scheme]?\x22:\x22+d.port:\x22\x22)+d.path+(d.query?d.query:\x22\x22)},c=function(b){function c(a){return[a.scheme,a.host,a.port].join(\x22/\x22)}return\x22string\x22==typeof b&&(b=a(b)),c(a())===c(b)};return{parseUrl:a,resolveUrl:b,hasSameOrigin:c}}),d(\x22moxie/runtime/RuntimeTarget\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/runtime/RuntimeClient\x22,\x22moxie/core/EventTarget\x22],function(a,b,c){function d(){this.uid=a.guid(\x22uid_\x22),b.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return d.prototype=c.instance,d}),d(\x22moxie/file/FileReaderSync\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/runtime/RuntimeClient\x22,\x22moxie/core/utils/Encode\x22],function(a,b,c){return function(){function d(a,b){if(!b.isDetached()){var d=this.connectRuntime(b.ruid).exec.call(this,\x22FileReaderSync\x22,\x22read\x22,a,b);return this.disconnectRuntime(),d}var e=b.getSource();switch(a){case\x22readAsBinaryString\x22:return e;case\x22readAsDataURL\x22:return\x22data:\x22+b.type+\x22;base64,\x22+c.btoa(e);case\x22readAsText\x22:for(var f=\x22\x22,g=0,h=e.length;g\x3ch;g++)f+=String.fromCharCode(e[g]);return f}}b.call(this),a.extend(this,{uid:a.guid(\x22uid_\x22),readAsBinaryString:function(a){return d.call(this,\x22readAsBinaryString\x22,a)},readAsDataURL:function(a){return d.call(this,\x22readAsDataURL\x22,a)},readAsText:function(a){return d.call(this,\x22readAsText\x22,a)}})}}),d(\x22moxie/xhr/FormData\x22,[\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/file/Blob\x22],function(a,b,c){function d(){var a,d=[];b.extend(this,{append:function(e,f){var g=this,h=b.typeOf(f);f instanceof c?a={name:e,value:f}:\x22array\x22===h?(e+=\x22[]\x22,b.each(f,function(a){g.append(e,a)})):\x22object\x22===h?b.each(f,function(a,b){g.append(e+\x22[\x22+b+\x22]\x22,a)}):\x22null\x22===h||\x22undefined\x22===h||\x22number\x22===h&&isNaN(f)?g.append(e,\x22false\x22):d.push({name:e,value:f.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(c){b.each(d,function(a){c(a.value,a.name)}),a&&c(a.value,a.name)},destroy:function(){a=null,d=[]}})}return d}),d(\x22moxie/xhr/XMLHttpRequest\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/EventTarget\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/core/utils/Url\x22,\x22moxie/runtime/Runtime\x22,\x22moxie/runtime/RuntimeTarget\x22,\x22moxie/file/Blob\x22,\x22moxie/file/FileReaderSync\x22,\x22moxie/xhr/FormData\x22,\x22moxie/core/utils/Env\x22,\x22moxie/core/utils/Mime\x22],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){this.uid=a.guid(\x22uid_\x22)}function n(){function c(a,b){if(A.hasOwnProperty(a))return 1===arguments.length?k.can(\x22define_property\x22)?A[a]:z[a]:void(k.can(\x22define_property\x22)?A[a]=b:z[a]=b)}function i(b){function d(){x&&(x.destroy(),x=null),h.dispatchEvent(\x22loadend\x22),h=null}function e(e){x.bind(\x22LoadStart\x22,function(a){c(\x22readyState\x22,n.LOADING),h.dispatchEvent(\x22readystatechange\x22),h.dispatchEvent(a),H&&h.upload.dispatchEvent(a)}),x.bind(\x22Progress\x22,function(a){c(\x22readyState\x22)!==n.LOADING&&(c(\x22readyState\x22,n.LOADING),h.dispatchEvent(\x22readystatechange\x22)),h.dispatchEvent(a)}),x.bind(\x22UploadProgress\x22,function(a){H&&h.upload.dispatchEvent({type:\x22progress\x22,lengthComputable:!1,total:a.total,loaded:a.loaded})}),x.bind(\x22Load\x22,function(b){c(\x22readyState\x22,n.DONE),c(\x22status\x22,Number(e.exec.call(x,\x22XMLHttpRequest\x22,\x22getStatus\x22)||0)),c(\x22statusText\x22,o[c(\x22status\x22)]||\x22\x22),c(\x22response\x22,e.exec.call(x,\x22XMLHttpRequest\x22,\x22getResponse\x22,c(\x22responseType\x22))),~a.inArray(c(\x22responseType\x22),[\x22text\x22,\x22\x22])?c(\x22responseText\x22,c(\x22response\x22)):\x22document\x22===c(\x22responseType\x22)&&c(\x22responseXML\x22,c(\x22response\x22)),O=e.exec.call(x,\x22XMLHttpRequest\x22,\x22getAllResponseHeaders\x22),h.dispatchEvent(\x22readystatechange\x22),c(\x22status\x22)\x3e0?(H&&h.upload.dispatchEvent(b),h.dispatchEvent(b)):(J=!0,h.dispatchEvent(\x22error\x22)),d()}),x.bind(\x22Abort\x22,function(a){h.dispatchEvent(a),d()}),x.bind(\x22Error\x22,function(a){J=!0,c(\x22readyState\x22,n.DONE),h.dispatchEvent(\x22readystatechange\x22),I=!0,h.dispatchEvent(a),d()}),e.exec.call(x,\x22XMLHttpRequest\x22,\x22send\x22,{url:r,method:s,async:B,user:t,password:u,headers:C,mimeType:E,encoding:D,responseType:h.responseType,withCredentials:h.withCredentials,options:N},b)}var h=this;v=(new Date).getTime(),x=new g,\x22string\x22==typeof N.required_caps&&(N.required_caps=f.parseCaps(N.required_caps)),N.required_caps=a.extend({},N.required_caps,{return_response_type:h.responseType}),b instanceof j&&(N.required_caps.send_multipart=!0),a.isEmptyObj(C)||(N.required_caps.send_custom_headers=!0),K||(N.required_caps.do_cors=!0),N.ruid?e(x.connectRuntime(N)):(x.bind(\x22RuntimeInit\x22,function(a,b){e(b)}),x.bind(\x22RuntimeError\x22,function(a,b){h.dispatchEvent(\x22RuntimeError\x22,b)}),x.connectRuntime(N))}function q(){c(\x22responseText\x22,\x22\x22),c(\x22responseXML\x22,null),c(\x22response\x22,null),c(\x22status\x22,0),c(\x22statusText\x22,\x22\x22),v=w=null}var r,s,t,u,v,w,x,y,z=this,A={timeout:0,readyState:n.UNSENT,withCredentials:!1,status:0,statusText:\x22\x22,responseType:\x22\x22,responseXML:null,responseText:null,response:null},B=!0,C={},D=null,E=null,F=!1,G=!1,H=!1,I=!1,J=!1,K=!1,L=null,M=null,N={},O=\x22\x22;a.extend(this,A,{uid:a.guid(\x22uid_\x22),upload:new m,open:function(f,g,h,i,j){var k;if(!f||!g)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\x5cu0100-\x5cuffff]/.test(f)||d.utf8_encode(f)!==f)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(~a.inArray(f.toUpperCase(),[\x22CONNECT\x22,\x22DELETE\x22,\x22GET\x22,\x22HEAD\x22,\x22OPTIONS\x22,\x22POST\x22,\x22PUT\x22,\x22TRACE\x22,\x22TRACK\x22])&&(s=f.toUpperCase()),~a.inArray(s,[\x22CONNECT\x22,\x22TRACE\x22,\x22TRACK\x22]))throw new b.DOMException(b.DOMException.SECURITY_ERR);if(g=d.utf8_encode(g),k=e.parseUrl(g),K=e.hasSameOrigin(k),r=e.resolveUrl(g),(i||j)&&!K)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);if(t=i||k.user,u=j||k.pass,B=h||!0,B===!1&&(c(\x22timeout\x22)||c(\x22withCredentials\x22)||\x22\x22!==c(\x22responseType\x22)))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);F=!B,G=!1,C={},q.call(this),c(\x22readyState\x22,n.OPENED),this.dispatchEvent(\x22readystatechange\x22)},setRequestHeader:function(e,f){var g=[\x22accept-charset\x22,\x22accept-encoding\x22,\x22access-control-request-headers\x22,\x22access-control-request-method\x22,\x22connection\x22,\x22content-length\x22,\x22cookie\x22,\x22cookie2\x22,\x22content-transfer-encoding\x22,\x22date\x22,\x22expect\x22,\x22host\x22,\x22keep-alive\x22,\x22origin\x22,\x22referer\x22,\x22te\x22,\x22trailer\x22,\x22transfer-encoding\x22,\x22upgrade\x22,\x22user-agent\x22,\x22via\x22];if(c(\x22readyState\x22)!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\x5cu0100-\x5cuffff]/.test(e)||d.utf8_encode(e)!==e)throw new b.DOMException(b.DOMException.SYNTAX_ERR);return e=a.trim(e).toLowerCase(),!~a.inArray(e,g)&&!/^(proxy\x5c-|sec\x5c-)/.test(e)&&(C[e]?C[e]+=\x22, \x22+f:C[e]=f,!0)},getAllResponseHeaders:function(){return O||\x22\x22},getResponseHeader:function(b){return b=b.toLowerCase(),J||~a.inArray(b,[\x22set-cookie\x22,\x22set-cookie2\x22])?null:O&&\x22\x22!==O&&(y||(y={},a.each(O.split(/\x5cr\x5cn/),function(b){var c=b.split(/:\x5cs+/);2===c.length&&(c[0]=a.trim(c[0]),y[c[0].toLowerCase()]={header:c[0],value:a.trim(c[1])})})),y.hasOwnProperty(b))?y[b].header+\x22: \x22+y[b].value:null},overrideMimeType:function(d){var e,f;if(~a.inArray(c(\x22readyState\x22),[n.LOADING,n.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(d=a.trim(d.toLowerCase()),/;/.test(d)&&(e=d.match(/^([^;]+)(?:;\x5cscharset\x5c=)?(.*)$/))&&(d=e[1],e[2]&&(f=e[2])),!l.mimes[d])throw new b.DOMException(b.DOMException.SYNTAX_ERR);L=d,M=f},send:function(c,e){if(N=\x22string\x22===a.typeOf(e)?{ruid:e}:e?e:{},this.readyState!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(c instanceof h)N.ruid=c.ruid,E=c.type||\x22application/octet-stream\x22;else if(c instanceof j){if(c.hasBlob()){var f=c.getBlob();N.ruid=f.ruid,E=f.type||\x22application/octet-stream\x22}}else\x22string\x22==typeof c&&(D=\x22UTF-8\x22,E=\x22text/plain;charset=UTF-8\x22,c=d.utf8_encode(c));this.withCredentials||(this.withCredentials=N.required_caps&&N.required_caps.send_browser_cookies&&!K),H=!F&&this.upload.hasEventListener(),J=!1,I=!c,F||(G=!0),i.call(this,c)},abort:function(){if(J=!0,F=!1,~a.inArray(c(\x22readyState\x22),[n.UNSENT,n.OPENED,n.DONE]))c(\x22readyState\x22,n.UNSENT);else{if(c(\x22readyState\x22,n.DONE),G=!1,!x)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);x.getRuntime().exec.call(x,\x22XMLHttpRequest\x22,\x22abort\x22,I),I=!0}},destroy:function(){x&&(\x22function\x22===a.typeOf(x.destroy)&&x.destroy(),x=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(p.concat([\x22readystatechange\x22])),this.upload.handleEventProps(p)}var o={100:\x22Continue\x22,101:\x22Switching Protocols\x22,102:\x22Processing\x22,200:\x22OK\x22,201:\x22Created\x22,202:\x22Accepted\x22,203:\x22Non-Authoritative Information\x22,204:\x22No Content\x22,205:\x22Reset Content\x22,206:\x22Partial Content\x22,207:\x22Multi-Status\x22,226:\x22IM Used\x22,300:\x22Multiple Choices\x22,301:\x22Moved Permanently\x22,302:\x22Found\x22,303:\x22See Other\x22,304:\x22Not Modified\x22,305:\x22Use Proxy\x22,306:\x22Reserved\x22,307:\x22Temporary Redirect\x22,400:\x22Bad Request\x22,401:\x22Unauthorized\x22,402:\x22Payment Required\x22,403:\x22Forbidden\x22,404:\x22Not Found\x22,405:\x22Method Not Allowed\x22,406:\x22Not Acceptable\x22,407:\x22Proxy Authentication Required\x22,408:\x22Request Timeout\x22,409:\x22Conflict\x22,410:\x22Gone\x22,411:\x22Length Required\x22,412:\x22Precondition Failed\x22,413:\x22Request Entity Too Large\x22,414:\x22Request-URI Too Long\x22,415:\x22Unsupported Media Type\x22,416:\x22Requested Range Not Satisfiable\x22,417:\x22Expectation Failed\x22,422:\x22Unprocessable Entity\x22,423:\x22Locked\x22,424:\x22Failed Dependency\x22,426:\x22Upgrade Required\x22,500:\x22Internal Server Error\x22,501:\x22Not Implemented\x22,502:\x22Bad Gateway\x22,503:\x22Service Unavailable\x22,504:\x22Gateway Timeout\x22,505:\x22HTTP Version Not Supported\x22,506:\x22Variant Also Negotiates\x22,507:\x22Insufficient Storage\x22,510:\x22Not Extended\x22};m.prototype=c.instance;var p=[\x22loadstart\x22,\x22progress\x22,\x22abort\x22,\x22error\x22,\x22load\x22,\x22timeout\x22,\x22loadend\x22];return n.UNSENT=0,n.OPENED=1,n.HEADERS_RECEIVED=2,n.LOADING=3,n.DONE=4,n.prototype=c.instance,n}),d(\x22moxie/runtime/Transporter\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/runtime/RuntimeClient\x22,\x22moxie/core/EventTarget\x22],function(a,b,c,d){function e(){function d(){k=l=0,j=this.result=null}function f(b,c){var d=this;i=c,d.bind(\x22TransportingProgress\x22,function(b){l=b.loaded,l\x3ck&&a.inArray(d.state,[e.IDLE,e.DONE])===-1&&g.call(d)},999),d.bind(\x22TransportingComplete\x22,function(){l=k,d.state=e.DONE,j=null,d.result=i.exec.call(d,\x22Transporter\x22,\x22getAsBlob\x22,b||\x22\x22)},999),d.state=e.BUSY,d.trigger(\x22TransportingStarted\x22),g.call(d)}function g(){var a,c=this,d=k-l;m\x3ed&&(m=d),a=b.btoa(j.substr(l,m)),i.exec.call(c,\x22Transporter\x22,\x22receive\x22,a,k)}var h,i,j,k,l,m;c.call(this),a.extend(this,{uid:a.guid(\x22uid_\x22),state:e.IDLE,result:null,transport:function(b,c,e){var g=this;if(e=a.extend({chunk_size:204798},e),(h=e.chunk_size%3)&&(e.chunk_size+=3-h),m=e.chunk_size,d.call(this),j=b,k=b.length,\x22string\x22===a.typeOf(e)||e.ruid)f.call(g,c,this.connectRuntime(e));else{var i=function(a,b){g.unbind(\x22RuntimeInit\x22,i),f.call(g,c,b)};this.bind(\x22RuntimeInit\x22,i),this.connectRuntime(e)}},abort:function(){var a=this;a.state=e.IDLE,i&&(i.exec.call(a,\x22Transporter\x22,\x22clear\x22),a.trigger(\x22TransportingAborted\x22)),d.call(a)},destroy:function(){this.unbindAll(),i=null,this.disconnectRuntime(),d.call(this)}})}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=d.instance,e}),d(\x22moxie/image/Image\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/Exceptions\x22,\x22moxie/file/FileReaderSync\x22,\x22moxie/xhr/XMLHttpRequest\x22,\x22moxie/runtime/Runtime\x22,\x22moxie/runtime/RuntimeClient\x22,\x22moxie/runtime/Transporter\x22,\x22moxie/core/utils/Env\x22,\x22moxie/core/EventTarget\x22,\x22moxie/file/Blob\x22,\x22moxie/file/File\x22,\x22moxie/core/utils/Encode\x22],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function d(a){a||(a=this.exec(\x22Image\x22,\x22getInfo\x22)),this.size=a.size,this.width=a.width,this.height=a.height,this.type=a.type,this.meta=a.meta,\x22\x22===this.name&&(this.name=a.name)}function j(b){var d=a.typeOf(b);try{if(b instanceof n){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);p.apply(this,arguments)}else if(b instanceof k){if(!~a.inArray(b.type,[\x22image/jpeg\x22,\x22image/png\x22]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);q.apply(this,arguments)}else if(a.inArray(d,[\x22blob\x22,\x22file\x22])!==-1)j.call(this,new l(null,b),arguments[1]);else if(\x22string\x22===d)\x22data:\x22===b.substr(0,5)?j.call(this,new k(null,{data:b}),arguments[1]):r.apply(this,arguments);else{if(\x22node\x22!==d||\x22img\x22!==b.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);j.call(this,b.src,arguments[1])}}catch(e){this.trigger(\x22error\x22,e.code)}}function p(b,c){var d=this.connectRuntime(b.ruid);this.ruid=d.uid,d.exec.call(this,\x22Image\x22,\x22loadFromImage\x22,b,\x22undefined\x22===a.typeOf(c)||c)}function q(b,c){function d(a){e.ruid=a.uid,a.exec.call(e,\x22Image\x22,\x22loadFromBlob\x22,b)}var e=this;e.name=b.name||\x22\x22,b.isDetached()?(this.bind(\x22RuntimeInit\x22,function(a,b){d(b)}),c&&\x22string\x22==typeof c.required_caps&&(c.required_caps=f.parseCaps(c.required_caps)),this.connectRuntime(a.extend({required_caps:{access_image_binary:!0,resize_image:!0}},c))):d(this.connectRuntime(b.ruid))}function r(a,b){var c,d=this;c=new e,c.open(\x22get\x22,a),c.responseType=\x22blob\x22,c.onprogress=function(a){d.trigger(a)},c.onload=function(){q.call(d,c.response,!0)},c.onerror=function(a){d.trigger(a)},c.onloadend=function(){c.destroy()},c.bind(\x22RuntimeError\x22,function(a,b){d.trigger(\x22RuntimeError\x22,b)}),c.send(null,b)}g.call(this),a.extend(this,{uid:a.guid(\x22uid_\x22),ruid:null,name:\x22\x22,size:0,width:0,height:0,type:\x22\x22,meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){j.apply(this,arguments)},downsize:function(b){var d={width:this.width,height:this.height,type:this.type||\x22image/jpeg\x22,quality:90,crop:!1,preserveHeaders:!0,resample:!1};b=\x22object\x22==typeof b?a.extend(d,b):a.extend(d,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width\x3en.MAX_RESIZE_WIDTH||this.height\x3en.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);this.exec(\x22Image\x22,\x22downsize\x22,b.width,b.height,b.crop,b.preserveHeaders)}catch(e){this.trigger(\x22error\x22,e.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!i.can(\x22create_canvas\x22))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);var a=this.connectRuntime(this.ruid);return a.exec.call(this,\x22Image\x22,\x22getAsCanvas\x22)},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.exec(\x22Image\x22,\x22getAsBlob\x22,a||\x22image/jpeg\x22,b||90)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.exec(\x22Image\x22,\x22getAsDataURL\x22,a||\x22image/jpeg\x22,b||90)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return m.atob(c.substring(c.indexOf(\x22base64,\x22)+7))},embed:function(d,e){function f(b,e){var f=this;if(i.can(\x22create_canvas\x22)){var k=f.getAsCanvas();if(k)return d.appendChild(k),k=null,f.destroy(),void j.trigger(\x22embedded\x22)}var l=f.getAsDataURL(b,e);if(!l)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(i.can(\x22use_data_uri_of\x22,l.length))d.innerHTML=\x27\x3cimg src=\x22\x27+l+\x27\x22 width=\x22\x27+f.width+\x27\x22 height=\x22\x27+f.height+\x27\x22 /\x3e\x27,f.destroy(),j.trigger(\x22embedded\x22);else{var n=new h;n.bind(\x22TransportingComplete\x22,function(){g=j.connectRuntime(this.result.ruid),j.bind(\x22Embedded\x22,function(){a.extend(g.getShimContainer().style,{top:\x220px\x22,left:\x220px\x22,width:f.width+\x22px\x22,height:f.height+\x22px\x22}),g=null},999),g.exec.call(j,\x22ImageView\x22,\x22display\x22,this.result.uid,width,height),f.destroy()}),n.transport(m.atob(l.substring(l.indexOf(\x22base64,\x22)+7)),b,{required_caps:{display_media:!0},runtime_order:\x22flash,silverlight\x22,container:d})}}var g,j=this;e=a.extend({width:this.width,height:this.height,type:this.type||\x22image/jpeg\x22,quality:90},e||{});try{if(!(d=b.get(d)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);this.width\x3en.MAX_RESIZE_WIDTH||this.height\x3en.MAX_RESIZE_HEIGHT;var k=new n;return k.bind(\x22Resize\x22,function(){f.call(this,e.type,e.quality)}),k.bind(\x22Load\x22,function(){k.downsize(e)}),this.meta.thumb&&this.meta.thumb.width\x3e=e.width&&this.meta.thumb.height\x3e=e.height?k.load(this.meta.thumb.data):k.clone(this,!1),k}catch(l){this.trigger(\x22error\x22,l.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,\x22Image\x22,\x22destroy\x22),this.disconnectRuntime()),this.unbindAll()}}),this.handleEventProps(o),this.bind(\x22Load Resize\x22,function(){d.call(this)},999)}var o=[\x22progress\x22,\x22load\x22,\x22error\x22,\x22resize\x22,\x22embedded\x22];return n.MAX_RESIZE_WIDTH=8192,n.MAX_RESIZE_HEIGHT=8192,n.prototype=j.instance,n}),d(\x22moxie/runtime/html5/Runtime\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/Exceptions\x22,\x22moxie/runtime/Runtime\x22,\x22moxie/core/utils/Env\x22],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue,j=a.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return e.can(\x22access_binary\x22)&&!!g.Image},display_media:h(d.can(\x22create_canvas\x22)||d.can(\x22use_data_uri_over32kb\x22)),do_cors:h(window.XMLHttpRequest&&\x22withCredentials\x22in new XMLHttpRequest),drag_and_drop:h(function(){var a=document.createElement(\x22div\x22);return(\x22draggable\x22in a||\x22ondragstart\x22in a&&\x22ondrop\x22in a)&&(\x22IE\x22!==d.browser||d.verComp(d.version,9,\x22\x3e\x22))}()),filter_by_extension:h(function(){return\x22Chrome\x22===d.browser&&d.verComp(d.version,28,\x22\x3e=\x22)||\x22IE\x22===d.browser&&d.verComp(d.version,10,\x22\x3e=\x22)||\x22Safari\x22===d.browser&&d.verComp(d.version,7,\x22\x3e=\x22)}()),return_response_headers:i,return_response_type:function(a){return!(\x22json\x22!==a||!window.JSON)||d.can(\x22return_response_type\x22,a)},return_status_code:i,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return e.can(\x22access_binary\x22)&&d.can(\x22create_canvas\x22)},select_file:function(){return d.can(\x22use_fileinput\x22)&&window.File},select_folder:function(){return e.can(\x22select_file\x22)&&\x22Chrome\x22===d.browser&&d.verComp(d.version,21,\x22\x3e=\x22)},select_multiple:function(){return e.can(\x22select_file\x22)&&!(\x22Safari\x22===d.browser&&\x22Windows\x22===d.os)&&!(\x22iOS\x22===d.os&&d.verComp(d.osVersion,\x227.0.0\x22,\x22\x3e\x22)&&d.verComp(d.osVersion,\x228.0.0\x22,\x22\x3c\x22))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||e.can(\x22send_binary_string\x22)},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return e.can(\x22slice_blob\x22)&&e.can(\x22send_multipart\x22)},summon_file_dialog:function(){return e.can(\x22select_file\x22)&&(\x22Firefox\x22===d.browser&&d.verComp(d.version,4,\x22\x3e=\x22)||\x22Opera\x22===d.browser&&d.verComp(d.version,12,\x22\x3e=\x22)||\x22IE\x22===d.browser&&d.verComp(d.version,10,\x22\x3e=\x22)||!!~a.inArray(d.browser,[\x22Chrome\x22,\x22Safari\x22]))},upload_filesize:i},arguments[2]);c.call(this,b,arguments[1]||f,j),a.extend(this,{init:function(){this.trigger(\x22Init\x22)},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f=\x22html5\x22,g={};return c.addConstructor(f,e),g}),d(\x22moxie/core/utils/Events\x22,[\x22moxie/core/utils/Basic\x22],function(a){function b(){this.returnValue=!1}function c(){this.cancelBubble=!0}var d={},e=\x22moxie_\x22+a.guid(),f=function(f,g,h,i){var j,k;g=g.toLowerCase(),f.addEventListener?(j=h,f.addEventListener(g,j,!1)):f.attachEvent&&(j=function(){var a=window.event;a.target||(a.target=a.srcElement),a.preventDefault=b,a.stopPropagation=c,h(a)},f.attachEvent(\x22on\x22+g,j)),f[e]||(f[e]=a.guid()),d.hasOwnProperty(f[e])||(d[f[e]]={}),k=d[f[e]],k.hasOwnProperty(g)||(k[g]=[]),k[g].push({func:j,orig:h,key:i})},g=function(b,c,f){var g,h;if(c=c.toLowerCase(),b[e]&&d[b[e]]&&d[b[e]][c]){g=d[b[e]][c];for(var i=g.length-1;i\x3e=0&&(g[i].orig!==f&&g[i].key!==f||(b.removeEventListener?b.removeEventListener(c,g[i].func,!1):b.detachEvent&&b.detachEvent(\x22on\x22+c,g[i].func),g[i].orig=null,g[i].func=null,g.splice(i,1),f===h));i--);if(g.length||delete d[b[e]][c],a.isEmptyObj(d[b[e]])){delete d[b[e]];try{delete b[e]}catch(j){b[e]=h}}}},h=function(b,c){b&&b[e]&&a.each(d[b[e]],function(a,d){g(b,d,c)})};return{addEvent:f,removeEvent:g,removeAllEvents:h}}),d(\x22moxie/runtime/html5/file/FileInput\x22,[\x22moxie/runtime/html5/Runtime\x22,\x22moxie/file/File\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/utils/Events\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/core/utils/Env\x22],function(a,b,c,d,e,f,g){function h(){var a;c.extend(this,{init:function(h){var i,j,k,l,m,n,o=this,p=o.getRuntime();a=h,k=a.accept.mimes||f.extList2mimes(a.accept,p.can(\x22filter_by_extension\x22)),j=p.getShimContainer(),j.innerHTML=\x27\x3cinput id=\x22\x27+p.uid+\x27\x22 type=\x22file\x22 style=\x22font-size:999px;opacity:0;\x22\x27+(a.multiple&&p.can(\x22select_multiple\x22)?\x22multiple\x22:\x22\x22)+(a.directory&&p.can(\x22select_folder\x22)?\x22webkitdirectory directory\x22:\x22\x22)+(k?\x27 accept=\x22\x27+k.join(\x22,\x22)+\x27\x22\x27:\x22\x22)+\x22 /\x3e\x22,i=d.get(p.uid),c.extend(i.style,{position:\x22absolute\x22,top:0,left:0,width:\x22100%\x22,height:\x22100%\x22}),l=d.get(a.browse_button),p.can(\x22summon_file_dialog\x22)&&(\x22static\x22===d.getStyle(l,\x22position\x22)&&(l.style.position=\x22relative\x22),m=parseInt(d.getStyle(l,\x22z-index\x22),10)||1,l.style.zIndex=m,j.style.zIndex=m-1,e.addEvent(l,\x22click\x22,function(a){var b=d.get(p.uid);b&&!b.disabled&&b.click(),a.preventDefault()},o.uid)),n=p.can(\x22summon_file_dialog\x22)?l:j,e.addEvent(n,\x22mouseover\x22,function(){o.trigger(\x22mouseenter\x22)},o.uid),e.addEvent(n,\x22mouseout\x22,function(){o.trigger(\x22mouseleave\x22)},o.uid),e.addEvent(n,\x22mousedown\x22,function(){o.trigger(\x22mousedown\x22)},o.uid),e.addEvent(d.get(a.container),\x22mouseup\x22,function(){o.trigger(\x22mouseup\x22)},o.uid),i.onchange=function q(d){if(o.files=[],c.each(this.files,function(c){var d=\x22\x22;return!(!a.directory||\x22.\x22!=c.name)||(c.webkitRelativePath&&(d=\x22/\x22+c.webkitRelativePath.replace(/^\x5c//,\x22\x22)),c=new b(p.uid,c),c.relativePath=d,void o.files.push(c))}),\x22IE\x22!==g.browser&&\x22IEMobile\x22!==g.browser)this.value=\x22\x22;else{var e=this.cloneNode(!0);this.parentNode.replaceChild(e,this),e.onchange=q}o.files.length&&o.trigger(\x22change\x22)},o.trigger({type:\x22ready\x22,async:!0}),j=null},disable:function(a){var b,c=this.getRuntime();(b=d.get(c.uid))&&(b.disabled=!!a)},destroy:function(){var b=this.getRuntime(),c=b.getShim(),f=b.getShimContainer();e.removeAllEvents(f,this.uid),e.removeAllEvents(a&&d.get(a.container),this.uid),e.removeAllEvents(a&&d.get(a.browse_button),this.uid),f&&(f.innerHTML=\x22\x22),c.removeInstance(this.uid),a=f=c=null}})}return a.FileInput=h}),d(\x22moxie/runtime/html5/file/Blob\x22,[\x22moxie/runtime/html5/Runtime\x22,\x22moxie/file/Blob\x22],function(a,b){function c(){function a(a,b,c){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(e){return a.slice(b,c-b)}}this.slice=function(){return new b(this.getRuntime().uid,a.apply(this,arguments))}}return a.Blob=c}),d(\x22moxie/runtime/html5/file/FileDrop\x22,[\x22moxie/runtime/html5/Runtime\x22,\x22moxie/file/File\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/utils/Events\x22,\x22moxie/core/utils/Mime\x22],function(a,b,c,d,e,f){function g(){function a(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;var b=c.toArray(a.dataTransfer.types||[]);return c.inArray(\x22Files\x22,b)!==-1||c.inArray(\x22public.file-url\x22,b)!==-1||c.inArray(\x22application/x-moz-file\x22,b)!==-1}function g(a,c){if(i(a)){var d=new b(o,a);d.relativePath=c||\x22\x22,p.push(d)}}function h(a){for(var b=[],d=0;d\x3ca.length;d++)[].push.apply(b,a[d].extensions.split(/\x5cs*,\x5cs*/));return c.inArray(\x22*\x22,b)===-1?b:[]}function i(a){if(!q.length)return!0;var b=f.getFileExtension(a.name);return!b||c.inArray(b,q)!==-1}function j(a,b){var d=[];c.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?g(a.getAsFile(),b.fullPath):d.push(b))}),d.length?k(d,b):b()}function k(a,b){var d=[];c.each(a,function(a){d.push(function(b){l(a,b)})}),c.inSeries(d,function(){b()})}function l(a,b){a.isFile?a.file(function(c){g(c,a.fullPath),b()},function(){b()}):a.isDirectory?m(a,b):b()}function m(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){k(d,b)})}var n,o,p=[],q=[];c.extend(this,{init:function(b){var d,f=this;n=b,o=f.ruid,q=h(n.accept),d=n.container,e.addEvent(d,\x22dragover\x22,function(b){a(b)&&(b.preventDefault(),b.dataTransfer.dropEffect=\x22copy\x22)},f.uid),e.addEvent(d,\x22drop\x22,function(b){a(b)&&(b.preventDefault(),p=[],b.dataTransfer.items&&b.dataTransfer.items[0].webkitGetAsEntry?j(b.dataTransfer.items,function(){f.files=p,f.trigger(\x22drop\x22)}):(c.each(b.dataTransfer.files,function(a){g(a)}),f.files=p,f.trigger(\x22drop\x22)))},f.uid),e.addEvent(d,\x22dragenter\x22,function(a){f.trigger(\x22dragenter\x22)},f.uid),e.addEvent(d,\x22dragleave\x22,function(a){f.trigger(\x22dragleave\x22)},f.uid)},destroy:function(){e.removeAllEvents(n&&d.get(n.container),this.uid),o=p=q=n=null}})}return a.FileDrop=g}),d(\x22moxie/runtime/html5/file/FileReader\x22,[\x22moxie/runtime/html5/Runtime\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/core/utils/Basic\x22],function(a,b,c){function d(){function a(a){return b.atob(a.substring(a.indexOf(\x22base64,\x22)+7))}var d,e=!1;c.extend(this,{read:function(b,f){var g=this;g.result=\x22\x22,d=new window.FileReader,d.addEventListener(\x22progress\x22,function(a){g.trigger(a)}),d.addEventListener(\x22load\x22,function(b){g.result=e?a(d.result):d.result,g.trigger(b)}),d.addEventListener(\x22error\x22,function(a){g.trigger(a,d.error)}),d.addEventListener(\x22loadend\x22,function(a){d=null,g.trigger(a)}),\x22function\x22===c.typeOf(d[b])?(e=!1,d[b](f.getSource())):\x22readAsBinaryString\x22===b&&(e=!0,d.readAsDataURL(f.getSource()))},abort:function(){d&&d.abort()},destroy:function(){d=null}})}return a.FileReader=d}),d(\x22moxie/runtime/html5/xhr/XMLHttpRequest\x22,[\x22moxie/runtime/html5/Runtime\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/core/utils/Url\x22,\x22moxie/file/File\x22,\x22moxie/file/Blob\x22,\x22moxie/xhr/FormData\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Env\x22],function(a,b,c,d,e,f,g,h,i){function j(){function a(a,b){var c,d,e=this;c=b.getBlob().getSource(),d=new window.FileReader,d.onload=function(){b.append(b.getBlobName(),new f(null,{type:c.type,data:d.result})),o.send.call(e,a,b)},d.readAsBinaryString(c)}function j(){return!window.XMLHttpRequest||\x22IE\x22===i.browser&&i.verComp(i.version,8,\x22\x3c\x22)?function(){for(var a=[\x22Msxml2.XMLHTTP.6.0\x22,\x22Microsoft.XMLHTTP\x22],b=0;b\x3ca.length;b++)try{return new ActiveXObject(a[b])}catch(c){}}():new window.XMLHttpRequest}function k(a){var b=a.responseXML,c=a.responseText;return\x22IE\x22===i.browser&&c&&b&&!b.documentElement&&/[^\x5c/]+\x5c/[^\x5c+]+\x5c+xml/.test(a.getResponseHeader(\x22Content-Type\x22))&&(b=new window.ActiveXObject(\x22Microsoft.XMLDOM\x22),b.async=!1,b.validateOnParse=!1,b.loadXML(c)),b&&(\x22IE\x22===i.browser&&0!==b.parseError||!b.documentElement||\x22parsererror\x22===b.documentElement.tagName)?null:b}function l(a){var b=\x22----moxieboundary\x22+(new Date).getTime(),c=\x22--\x22,d=\x22\x5cr\x5cn\x22,e=\x22\x22,g=this.getRuntime();if(!g.can(\x22send_binary_string\x22))throw new h.RuntimeError(h.RuntimeError.NOT_SUPPORTED_ERR);return m.setRequestHeader(\x22Content-Type\x22,\x22multipart/form-data; boundary=\x22+b),a.each(function(a,g){e+=a instanceof f?c+b+d+\x27Content-Disposition: form-data; name=\x22\x27+g+\x27\x22; filename=\x22\x27+unescape(encodeURIComponent(a.name||\x22blob\x22))+\x27\x22\x27+d+\x22Content-Type: \x22+(a.type||\x22application/octet-stream\x22)+d+d+a.getSource()+d:c+b+d+\x27Content-Disposition: form-data; name=\x22\x27+g+\x27\x22\x27+d+d+unescape(encodeURIComponent(a))+d}),e+=c+b+c+d}var m,n,o=this;b.extend(this,{send:function(c,e){var h=this,k=\x22Mozilla\x22===i.browser&&i.verComp(i.version,4,\x22\x3e=\x22)&&i.verComp(i.version,7,\x22\x3c\x22),o=\x22Android Browser\x22===i.browser,p=!1;if(n=c.url.replace(/^.+?\x5c/([\x5cw\x5c-\x5c.]+)$/,\x22$1\x22).toLowerCase(),m=j(),m.open(c.method,c.url,c.async,c.user,c.password),e instanceof f)e.isDetached()&&(p=!0),e=e.getSource();else if(e instanceof g){if(e.hasBlob())if(e.getBlob().isDetached())e=l.call(h,e),p=!0;else if((k||o)&&\x22blob\x22===b.typeOf(e.getBlob().getSource())&&window.FileReader)return void a.call(h,c,e);if(e instanceof g){var q=new window.FormData;e.each(function(a,b){a instanceof f?q.append(b,a.getSource()):q.append(b,a)}),e=q}}m.upload?(c.withCredentials&&(m.withCredentials=!0),m.addEventListener(\x22load\x22,function(a){h.trigger(a)}),m.addEventListener(\x22error\x22,function(a){h.trigger(a)}),m.addEventListener(\x22progress\x22,function(a){h.trigger(a)}),m.upload.addEventListener(\x22progress\x22,function(a){h.trigger({type:\x22UploadProgress\x22,loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 1:break;case 2:break;case 3:var a,b;try{d.hasSameOrigin(c.url)&&(a=m.getResponseHeader(\x22Content-Length\x22)||0),m.responseText&&(b=m.responseText.length)}catch(e){a=b=0}h.trigger({type:\x22progress\x22,lengthComputable:!!a,total:parseInt(a,10),loaded:b});break;case 4:m.onreadystatechange=function(){},0===m.status?h.trigger(\x22error\x22):h.trigger(\x22load\x22)}},b.isEmptyObj(c.headers)||b.each(c.headers,function(a,b){m.setRequestHeader(b,a)}),\x22\x22!==c.responseType&&\x22responseType\x22in m&&(\x22json\x22!==c.responseType||i.can(\x22return_response_type\x22,\x22json\x22)?m.responseType=c.responseType:m.responseType=\x22text\x22),p?m.sendAsBinary?m.sendAsBinary(e):!function(){for(var a=new Uint8Array(e.length),b=0;b\x3ce.length;b++)a[b]=255&e.charCodeAt(b);m.send(a.buffer)}():m.send(e),h.trigger(\x22loadstart\x22)},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case\x22blob\x22:var d=new e(b.uid,m.response),f=m.getResponseHeader(\x22Content-Disposition\x22);if(f){var g=f.match(/filename=([\x5c\x27\x5c\x22\x27])([^\x5c1]+)\x5c1/);g&&(n=g[2])}return d.name=n,d.type||(d.type=c.getFileMime(n)),d;case\x22json\x22:return i.can(\x22return_response_type\x22,\x22json\x22)?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case\x22document\x22:return k(m);default:return\x22\x22!==m.responseText?m.responseText:null}}catch(h){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return\x22\x22},abort:function(){m&&m.abort()},destroy:function(){o=n=null}})}return a.XMLHttpRequest=j}),d(\x22moxie/runtime/html5/utils/BinaryReader\x22,[\x22moxie/core/utils/Basic\x22],function(a){function b(a){a instanceof ArrayBuffer?c.apply(this,arguments):d.apply(this,arguments)}function c(b){var c=new DataView(b);a.extend(this,{readByteAt:function(a){return c.getUint8(a)},writeByteAt:function(a,b){c.setUint8(a,b)},SEGMENT:function(a,d,e){switch(arguments.length){case 2:return b.slice(a,a+d);case 1:return b.slice(a);case 3:if(null===e&&(e=new ArrayBuffer),e instanceof ArrayBuffer){var f=new Uint8Array(this.length()-d+e.byteLength);a\x3e0&&f.set(new Uint8Array(b.slice(0,a)),0),f.set(new Uint8Array(e),a),f.set(new Uint8Array(b.slice(a+d)),a+e.byteLength),this.clear(),b=f.buffer,c=new DataView(b);\x0abreak}default:return b}},length:function(){return b?b.byteLength:0},clear:function(){c=b=null}})}function d(b){function c(a,c,d){d=3===arguments.length?d:b.length-c-1,b=b.substr(0,c)+a+b.substr(d+c)}a.extend(this,{readByteAt:function(a){return b.charCodeAt(a)},writeByteAt:function(a,b){c(String.fromCharCode(b),a,1)},SEGMENT:function(a,d,e){switch(arguments.length){case 1:return b.substr(a);case 2:return b.substr(a,d);case 3:c(null!==e?e:\x22\x22,a,d);break;default:return b}},length:function(){return b?b.length:0},clear:function(){b=null}})}return a.extend(b.prototype,{littleEndian:!1,read:function(a,b){var c,d,e;if(a+b\x3ethis.length())throw new Error(\x22You are trying to read outside the source boundaries.\x22);for(d=this.littleEndian?0:-8*(b-1),e=0,c=0;e\x3cb;e++)c|=this.readByteAt(a+e)\x3c\x3cMath.abs(d+8*e);return c},write:function(a,b,c){var d,e;if(a\x3ethis.length())throw new Error(\x22You are trying to write outside the source boundaries.\x22);for(d=this.littleEndian?0:-8*(c-1),e=0;e\x3cc;e++)this.writeByteAt(a+e,b\x3e\x3eMath.abs(d+8*e)&255)},BYTE:function(a){return this.read(a,1)},SHORT:function(a){return this.read(a,2)},LONG:function(a){return this.read(a,4)},SLONG:function(a){var b=this.read(a,4);return b\x3e2147483647?b-4294967296:b},CHAR:function(a){return String.fromCharCode(this.read(a,1))},STRING:function(a,b){return this.asArray(\x22CHAR\x22,a,b).join(\x22\x22)},asArray:function(a,b,c){for(var d=[],e=0;e\x3cc;e++)d[e]=this[a](b+e);return d}}),b}),d(\x22moxie/runtime/html5/image/JPEGHeaders\x22,[\x22moxie/runtime/html5/utils/BinaryReader\x22,\x22moxie/core/Exceptions\x22],function(a,b){return function c(d){var e,f,g,h=[],i=0;if(e=new a(d),65496!==e.SHORT(0))throw e.clear(),new b.ImageError(b.ImageError.WRONG_FORMAT);for(f=2;f\x3c=e.length();)if(g=e.SHORT(f),g\x3e=65488&&g\x3c=65495)f+=2;else{if(65498===g||65497===g)break;i=e.SHORT(f+2)+2,g\x3e=65505&&g\x3c=65519&&h.push({hex:g,name:\x22APP\x22+(15&g),start:f,length:i,segment:e.SEGMENT(f,i)}),f+=i}return e.clear(),{headers:h,restore:function(b){var c,d,e;for(e=new a(b),f=65504==e.SHORT(2)?4+e.SHORT(4):2,d=0,c=h.length;d\x3cc;d++)e.SEGMENT(f,0,h[d].segment),f+=h[d].length;return b=e.SEGMENT(),e.clear(),b},strip:function(b){var d,e,f,g;for(f=new c(b),e=f.headers,f.purge(),d=new a(b),g=e.length;g--;)d.SEGMENT(e[g].start,e[g].length,\x22\x22);return b=d.SEGMENT(),d.clear(),b},get:function(a){for(var b=[],c=0,d=h.length;c\x3cd;c++)h[c].name===a.toUpperCase()&&b.push(h[c].segment);return b},set:function(a,b){var c,d,e,f=[];for(\x22string\x22==typeof b?f.push(b):f=b,c=d=0,e=h.length;c\x3ce&&(h[c].name===a.toUpperCase()&&(h[c].segment=f[d],h[c].length=f[d].length,d++),!(d\x3e=f.length));c++);},purge:function(){this.headers=h=[]}}}}),d(\x22moxie/runtime/html5/image/ExifParser\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/runtime/html5/utils/BinaryReader\x22,\x22moxie/core/Exceptions\x22],function(a,c,d){function e(f){function g(c,e){var f,g,h,i,j,m,n,o,p=this,q=[],r={},s={1:\x22BYTE\x22,7:\x22UNDEFINED\x22,2:\x22ASCII\x22,3:\x22SHORT\x22,4:\x22LONG\x22,5:\x22RATIONAL\x22,9:\x22SLONG\x22,10:\x22SRATIONAL\x22},t={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(f=p.SHORT(c),g=0;g\x3cf;g++)if(q=[],n=c+2+12*g,h=e[p.SHORT(n)],h!==b){if(i=s[p.SHORT(n+=2)],j=p.LONG(n+=2),m=t[i],!m)throw new d.ImageError(d.ImageError.INVALID_META_ERR);if(n+=4,m*j\x3e4&&(n=p.LONG(n)+l.tiffHeader),n+m*j\x3e=this.length())throw new d.ImageError(d.ImageError.INVALID_META_ERR);\x22ASCII\x22!==i?(q=p.asArray(i,n,j),o=1==j?q[0]:q,k.hasOwnProperty(h)&&\x22object\x22!=typeof o?r[h]=k[h][o]:r[h]=o):r[h]=a.trim(p.STRING(n,j).replace(/\x5c0$/,\x22\x22))}return r}function h(a,b,c){var d,e,f,g=0;if(\x22string\x22==typeof b){var h=j[a.toLowerCase()];for(var i in h)if(h[i]===b){b=i;break}}d=l[a.toLowerCase()+\x22IFD\x22],e=this.SHORT(d);for(var k=0;k\x3ce;k++)if(f=d+12*k+2,this.SHORT(f)==b){g=f+8;break}if(!g)return!1;try{this.write(g,c,4)}catch(m){return!1}return!0}var i,j,k,l,m,n;if(c.call(this,f),j={tiff:{274:\x22Orientation\x22,270:\x22ImageDescription\x22,271:\x22Make\x22,272:\x22Model\x22,305:\x22Software\x22,34665:\x22ExifIFDPointer\x22,34853:\x22GPSInfoIFDPointer\x22},exif:{36864:\x22ExifVersion\x22,40961:\x22ColorSpace\x22,40962:\x22PixelXDimension\x22,40963:\x22PixelYDimension\x22,36867:\x22DateTimeOriginal\x22,33434:\x22ExposureTime\x22,33437:\x22FNumber\x22,34855:\x22ISOSpeedRatings\x22,37377:\x22ShutterSpeedValue\x22,37378:\x22ApertureValue\x22,37383:\x22MeteringMode\x22,37384:\x22LightSource\x22,37385:\x22Flash\x22,37386:\x22FocalLength\x22,41986:\x22ExposureMode\x22,41987:\x22WhiteBalance\x22,41990:\x22SceneCaptureType\x22,41988:\x22DigitalZoomRatio\x22,41992:\x22Contrast\x22,41993:\x22Saturation\x22,41994:\x22Sharpness\x22},gps:{0:\x22GPSVersionID\x22,1:\x22GPSLatitudeRef\x22,2:\x22GPSLatitude\x22,3:\x22GPSLongitudeRef\x22,4:\x22GPSLongitude\x22},thumb:{513:\x22JPEGInterchangeFormat\x22,514:\x22JPEGInterchangeFormatLength\x22}},k={ColorSpace:{1:\x22sRGB\x22,0:\x22Uncalibrated\x22},MeteringMode:{0:\x22Unknown\x22,1:\x22Average\x22,2:\x22CenterWeightedAverage\x22,3:\x22Spot\x22,4:\x22MultiSpot\x22,5:\x22Pattern\x22,6:\x22Partial\x22,255:\x22Other\x22},LightSource:{1:\x22Daylight\x22,2:\x22Fliorescent\x22,3:\x22Tungsten\x22,4:\x22Flash\x22,9:\x22Fine weather\x22,10:\x22Cloudy weather\x22,11:\x22Shade\x22,12:\x22Daylight fluorescent (D 5700 - 7100K)\x22,13:\x22Day white fluorescent (N 4600 -5400K)\x22,14:\x22Cool white fluorescent (W 3900 - 4500K)\x22,15:\x22White fluorescent (WW 3200 - 3700K)\x22,17:\x22Standard light A\x22,18:\x22Standard light B\x22,19:\x22Standard light C\x22,20:\x22D55\x22,21:\x22D65\x22,22:\x22D75\x22,23:\x22D50\x22,24:\x22ISO studio tungsten\x22,255:\x22Other\x22},Flash:{0:\x22Flash did not fire\x22,1:\x22Flash fired\x22,5:\x22Strobe return light not detected\x22,7:\x22Strobe return light detected\x22,9:\x22Flash fired, compulsory flash mode\x22,13:\x22Flash fired, compulsory flash mode, return light not detected\x22,15:\x22Flash fired, compulsory flash mode, return light detected\x22,16:\x22Flash did not fire, compulsory flash mode\x22,24:\x22Flash did not fire, auto mode\x22,25:\x22Flash fired, auto mode\x22,29:\x22Flash fired, auto mode, return light not detected\x22,31:\x22Flash fired, auto mode, return light detected\x22,32:\x22No flash function\x22,65:\x22Flash fired, red-eye reduction mode\x22,69:\x22Flash fired, red-eye reduction mode, return light not detected\x22,71:\x22Flash fired, red-eye reduction mode, return light detected\x22,73:\x22Flash fired, compulsory flash mode, red-eye reduction mode\x22,77:\x22Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\x22,79:\x22Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\x22,89:\x22Flash fired, auto mode, red-eye reduction mode\x22,93:\x22Flash fired, auto mode, return light not detected, red-eye reduction mode\x22,95:\x22Flash fired, auto mode, return light detected, red-eye reduction mode\x22},ExposureMode:{0:\x22Auto exposure\x22,1:\x22Manual exposure\x22,2:\x22Auto bracket\x22},WhiteBalance:{0:\x22Auto white balance\x22,1:\x22Manual white balance\x22},SceneCaptureType:{0:\x22Standard\x22,1:\x22Landscape\x22,2:\x22Portrait\x22,3:\x22Night scene\x22},Contrast:{0:\x22Normal\x22,1:\x22Soft\x22,2:\x22Hard\x22},Saturation:{0:\x22Normal\x22,1:\x22Low saturation\x22,2:\x22High saturation\x22},Sharpness:{0:\x22Normal\x22,1:\x22Soft\x22,2:\x22Hard\x22},GPSLatitudeRef:{N:\x22North latitude\x22,S:\x22South latitude\x22},GPSLongitudeRef:{E:\x22East longitude\x22,W:\x22West longitude\x22}},l={tiffHeader:10},m=l.tiffHeader,i={clear:this.clear},a.extend(this,{read:function(){try{return e.prototype.read.apply(this,arguments)}catch(a){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},write:function(){try{return e.prototype.write.apply(this,arguments)}catch(a){throw new d.ImageError(d.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(a){return this.LONG(a)/this.LONG(a+4)},SRATIONAL:function(a){return this.SLONG(a)/this.SLONG(a+4)},ASCII:function(a){return this.CHAR(a)},TIFF:function(){return n||null},EXIF:function(){var b=null;if(l.exifIFD){try{b=g.call(this,l.exifIFD,j.exif)}catch(c){return null}if(b.ExifVersion&&\x22array\x22===a.typeOf(b.ExifVersion)){for(var d=0,e=\x22\x22;d\x3cb.ExifVersion.length;d++)e+=String.fromCharCode(b.ExifVersion[d]);b.ExifVersion=e}}return b},GPS:function(){var b=null;if(l.gpsIFD){try{b=g.call(this,l.gpsIFD,j.gps)}catch(c){return null}b.GPSVersionID&&\x22array\x22===a.typeOf(b.GPSVersionID)&&(b.GPSVersionID=b.GPSVersionID.join(\x22.\x22))}return b},thumb:function(){if(l.IFD1)try{var a=g.call(this,l.IFD1,j.thumb);if(\x22JPEGInterchangeFormat\x22in a)return this.SEGMENT(l.tiffHeader+a.JPEGInterchangeFormat,a.JPEGInterchangeFormatLength)}catch(b){}return null},setExif:function(a,b){return(\x22PixelXDimension\x22===a||\x22PixelYDimension\x22===a)&&h.call(this,\x22exif\x22,a,b)},clear:function(){i.clear(),f=j=k=n=l=i=null}}),65505!==this.SHORT(0)||\x22EXIF\x5c0\x22!==this.STRING(4,5).toUpperCase())throw new d.ImageError(d.ImageError.INVALID_META_ERR);if(this.littleEndian=18761==this.SHORT(m),42!==this.SHORT(m+=2))throw new d.ImageError(d.ImageError.INVALID_META_ERR);l.IFD0=l.tiffHeader+this.LONG(m+=2),n=g.call(this,l.IFD0,j.tiff),\x22ExifIFDPointer\x22in n&&(l.exifIFD=l.tiffHeader+n.ExifIFDPointer,delete n.ExifIFDPointer),\x22GPSInfoIFDPointer\x22in n&&(l.gpsIFD=l.tiffHeader+n.GPSInfoIFDPointer,delete n.GPSInfoIFDPointer),a.isEmptyObj(n)&&(n=null);var o=this.LONG(l.IFD0+12*this.SHORT(l.IFD0)+2);o&&(l.IFD1=l.tiffHeader+o)}return e.prototype=c.prototype,e}),d(\x22moxie/runtime/html5/image/JPEG\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/Exceptions\x22,\x22moxie/runtime/html5/image/JPEGHeaders\x22,\x22moxie/runtime/html5/utils/BinaryReader\x22,\x22moxie/runtime/html5/image/ExifParser\x22],function(a,b,c,d,e){function f(f){function g(a){var b,c,d=0;for(a||(a=j);d\x3c=a.length();){if(b=a.SHORT(d+=2),b\x3e=65472&&b\x3c=65475)return d+=5,{height:a.SHORT(d),width:a.SHORT(d+=2)};c=a.SHORT(d+=2),d+=c-2}return null}function h(){var a,b,c=l.thumb();return c&&(a=new d(c),b=g(a),a.clear(),b)?(b.data=c,b):null}function i(){l&&k&&j&&(l.clear(),k.purge(),j.clear(),m=k=l=j=null)}var j,k,l,m;if(j=new d(f),65496!==j.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);k=new c(f);try{l=new e(k.get(\x22app1\x22)[0])}catch(n){}m=g.call(this),a.extend(this,{type:\x22image/jpeg\x22,size:j.length(),width:m&&m.width||0,height:m&&m.height||0,setExif:function(b,c){return!!l&&(\x22object\x22===a.typeOf(b)?a.each(b,function(a,b){l.setExif(b,a)}):l.setExif(b,c),void k.set(\x22app1\x22,l.SEGMENT()))},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):k.restore(f)},stripHeaders:function(a){return k.strip(a)},purge:function(){i.call(this)}}),l&&(this.meta={tiff:l.TIFF(),exif:l.EXIF(),gps:l.GPS(),thumb:h()})}return f}),d(\x22moxie/runtime/html5/image/PNG\x22,[\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/runtime/html5/utils/BinaryReader\x22],function(a,b,c){function d(d){function e(){var a,b;return a=g.call(this,8),\x22IHDR\x22==a.type?(b=a.start,{width:h.LONG(b),height:h.LONG(b+=4)}):null}function f(){h&&(h.clear(),d=k=i=j=h=null)}function g(a){var b,c,d,e;return b=h.LONG(a),c=h.STRING(a+=4,4),d=a+=4,e=h.LONG(a+b),{length:b,type:c,start:d,CRC:e}}var h,i,j,k;h=new c(d),function(){var b=0,c=0,d=[35152,20039,3338,6666];for(c=0;c\x3cd.length;c++,b+=2)if(d[c]!=h.SHORT(b))throw new a.ImageError(a.ImageError.WRONG_FORMAT)}(),k=e.call(this),b.extend(this,{type:\x22image/png\x22,size:h.length(),width:k.width,height:k.height,purge:function(){f.call(this)}}),f.call(this)}return d}),d(\x22moxie/runtime/html5/image/ImageInfo\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/Exceptions\x22,\x22moxie/runtime/html5/image/JPEG\x22,\x22moxie/runtime/html5/image/PNG\x22],function(a,b,c,d){return function(e){var f,g=[c,d];f=function(){for(var a=0;a\x3cg.length;a++)try{return new g[a](e)}catch(c){}throw new b.ImageError(b.ImageError.WRONG_FORMAT)}(),a.extend(this,{type:\x22\x22,size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){e=null}}),a.extend(this,f),this.purge=function(){f.purge(),f=null}}}),d(\x22moxie/runtime/html5/image/MegaPixel\x22,[],function(){function a(a,d,e){var f=a.naturalWidth,g=a.naturalHeight,h=e.width,i=e.height,j=e.x||0,k=e.y||0,l=d.getContext(\x222d\x22);b(a)&&(f/=2,g/=2);var m=1024,n=document.createElement(\x22canvas\x22);n.width=n.height=m;for(var o=n.getContext(\x222d\x22),p=c(a,f,g),q=0;q\x3cg;){for(var r=q+m\x3eg?g-q:m,s=0;s\x3cf;){var t=s+m\x3ef?f-s:m;o.clearRect(0,0,m,m),o.drawImage(a,-s,-q);var u=s*h/f+j\x3c\x3c0,v=Math.ceil(t*h/f),w=q*i/g/p+k\x3c\x3c0,x=Math.ceil(r*i/g/p);l.drawImage(n,0,0,t,r,u,w,v,x),s+=m}q+=m}n=o=null}function b(a){var b=a.naturalWidth,c=a.naturalHeight;if(b*c\x3e1048576){var d=document.createElement(\x22canvas\x22);d.width=d.height=1;var e=d.getContext(\x222d\x22);return e.drawImage(a,-b+1,0),0===e.getImageData(0,0,1,1).data[3]}return!1}function c(a,b,c){var d=document.createElement(\x22canvas\x22);d.width=1,d.height=c;var e=d.getContext(\x222d\x22);e.drawImage(a,0,0);for(var f=e.getImageData(0,0,1,c).data,g=0,h=c,i=c;i\x3eg;){var j=f[4*(i-1)+3];0===j?h=i:g=i,i=h+g\x3e\x3e1}d=null;var k=i/c;return 0===k?1:k}return{isSubsampled:b,renderTo:a}}),d(\x22moxie/runtime/html5/image/Image\x22,[\x22moxie/runtime/html5/Runtime\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/file/Blob\x22,\x22moxie/file/File\x22,\x22moxie/runtime/html5/image/ImageInfo\x22,\x22moxie/runtime/html5/image/MegaPixel\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/core/utils/Env\x22],function(a,b,c,d,e,f,g,h,i,j){function k(){function a(){if(!u&&!s)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return u||s}function k(a){return d.atob(a.substring(a.indexOf(\x22base64,\x22)+7))}function l(a,b){return\x22data:\x22+(b||\x22\x22)+\x22;base64,\x22+d.btoa(a)}function m(a){var b=this;s=new Image,s.onerror=function(){r.call(this),b.trigger(\x22error\x22,c.ImageError.WRONG_FORMAT)},s.onload=function(){b.trigger(\x22load\x22)},s.src=\x22data:\x22==a.substr(0,5)?a:l(a,w.type)}function n(a,b){var d,e=this;return window.FileReader?(d=new FileReader,d.onload=function(){b(this.result)},d.onerror=function(){e.trigger(\x22error\x22,c.ImageError.WRONG_FORMAT)},d.readAsDataURL(a),void 0):b(a.getAsDataURL())}function o(c,d,e,f){var g,h,i,j,k,l=this,m=0,n=0;if(z=f,k=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,b.inArray(k,[5,6,7,8])!==-1){var o=c;c=d,d=o}return h=a(),e?(c=Math.min(c,h.width),d=Math.min(d,h.height),g=Math.max(c/h.width,d/h.height)):g=Math.min(c/h.width,d/h.height),g\x3e1&&!e&&f?void this.trigger(\x22Resize\x22):(u||(u=document.createElement(\x22canvas\x22)),i=Math.round(h.width*g),j=Math.round(h.height*g),e?(u.width=c,u.height=d,i\x3ec&&(m=Math.round((i-c)/2)),j\x3ed&&(n=Math.round((j-d)/2))):(u.width=i,u.height=j),z||q(u.width,u.height,k),p.call(this,h,u,-m,-n,i,j),this.width=u.width,this.height=u.height,y=!0,void l.trigger(\x22Resize\x22))}function p(a,b,c,d,e,f){if(\x22iOS\x22===j.OS)h.renderTo(a,b,{width:e,height:f,x:c,y:d});else{var g=b.getContext(\x222d\x22);g.drawImage(a,c,d,e,f)}}function q(a,b,c){switch(c){case 5:case 6:case 7:case 8:u.width=b,u.height=a;break;default:u.width=a,u.height=b}var d=u.getContext(\x222d\x22);switch(c){case 2:d.translate(a,0),d.scale(-1,1);break;case 3:d.translate(a,b),d.rotate(Math.PI);break;case 4:d.translate(0,b),d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI),d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI),d.translate(0,-b);break;case 7:d.rotate(.5*Math.PI),d.translate(a,-b),d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-a,0)}}function r(){t&&(t.purge(),t=null),v=s=u=w=null,y=!1}var s,t,u,v,w,x=this,y=!1,z=!0;b.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=!(arguments.length\x3e1)||arguments[1];if(!d.can(\x22access_binary\x22))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return w=a,a.isDetached()?(v=a.getSource(),void m.call(this,v)):void n.call(this,a.getSource(),function(a){e&&(v=k(a)),m.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta,w=new f(null,{name:a.name,size:a.size,type:a.type}),m.call(this,b?v=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b,c=this.getRuntime();return!t&&v&&c.can(\x22access_image_binary\x22)&&(t=new g(v)),b={width:a().width||0,height:a().height||0,type:w.type||i.getFileMime(w.name),size:v&&v.length||w.size||0,name:w.name||\x22\x22,meta:t&&t.meta||this.meta||{}},!b.meta||!b.meta.thumb||b.meta.thumb.data instanceof e||(b.meta.thumb.data=new e(null,{type:\x22image/jpeg\x22,data:b.meta.thumb.data})),b},downsize:function(){o.apply(this,arguments)},getAsCanvas:function(){return u&&(u.id=this.uid+\x22_canvas\x22),u},getAsBlob:function(a,b){return a!==this.type&&o.call(this,this.width,this.height,!1),new f(null,{name:w.name||\x22\x22,type:a,data:x.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a){var b=arguments[1]||90;if(!y)return s.src;if(\x22image/jpeg\x22!==a)return u.toDataURL(\x22image/png\x22);try{return u.toDataURL(\x22image/jpeg\x22,b/100)}catch(c){return u.toDataURL(\x22image/jpeg\x22)}},getAsBinaryString:function(a,b){if(!y)return v||(v=k(x.getAsDataURL(a,b))),v;if(\x22image/jpeg\x22!==a)v=k(x.getAsDataURL(a,b));else{var c;b||(b=90);try{c=u.toDataURL(\x22image/jpeg\x22,b/100)}catch(d){c=u.toDataURL(\x22image/jpeg\x22)}v=k(c),t&&(v=t.stripHeaders(v),z&&(t.meta&&t.meta.exif&&t.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),v=t.writeHeaders(v)),t.purge(),t=null)}return y=!1,v},destroy:function(){x=null,r.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return a.Image=k}),d(\x22moxie/runtime/flash/Runtime\x22,[],function(){return{}}),d(\x22moxie/runtime/silverlight/Runtime\x22,[],function(){return{}}),d(\x22moxie/runtime/html4/Runtime\x22,[\x22moxie/core/utils/Basic\x22,\x22moxie/core/Exceptions\x22,\x22moxie/runtime/Runtime\x22,\x22moxie/core/utils/Env\x22],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue;c.call(this,b,f,{access_binary:h(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:h(g.Image&&(d.can(\x22create_canvas\x22)||d.can(\x22use_data_uri_over32kb\x22))),do_cors:!1,drag_and_drop:!1,filter_by_extension:h(function(){return\x22Chrome\x22===d.browser&&d.verComp(d.version,28,\x22\x3e=\x22)||\x22IE\x22===d.browser&&d.verComp(d.version,10,\x22\x3e=\x22)||\x22Safari\x22===d.browser&&d.verComp(d.version,7,\x22\x3e=\x22)}()),resize_image:function(){return g.Image&&e.can(\x22access_binary\x22)&&d.can(\x22create_canvas\x22)},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(b){return!(\x22json\x22!==b||!window.JSON)||!!~a.inArray(b,[\x22text\x22,\x22document\x22,\x22\x22])},return_status_code:function(b){return!a.arrayDiff(b,[200,404])},select_file:function(){return d.can(\x22use_fileinput\x22)},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can(\x22select_file\x22)},summon_file_dialog:function(){return e.can(\x22select_file\x22)&&(\x22Firefox\x22===d.browser&&d.verComp(d.version,4,\x22\x3e=\x22)||\x22Opera\x22===d.browser&&d.verComp(d.version,12,\x22\x3e=\x22)||\x22IE\x22===d.browser&&d.verComp(d.version,10,\x22\x3e=\x22)||!!~a.inArray(d.browser,[\x22Chrome\x22,\x22Safari\x22]))},upload_filesize:i,use_http_method:function(b){return!a.arrayDiff(b,[\x22GET\x22,\x22POST\x22])}}),a.extend(this,{init:function(){this.trigger(\x22Init\x22)},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f=\x22html4\x22,g={};return c.addConstructor(f,e),g}),d(\x22moxie/runtime/html4/file/FileInput\x22,[\x22moxie/runtime/html4/Runtime\x22,\x22moxie/file/File\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/utils/Events\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/core/utils/Env\x22],function(a,b,c,d,e,f,g){function h(){function a(){var f,k,l,m,n,o,p=this,q=p.getRuntime();o=c.guid(\x22uid_\x22),f=q.getShimContainer(),h&&(l=d.get(h+\x22_form\x22),l&&c.extend(l.style,{top:\x22100%\x22})),m=document.createElement(\x22form\x22),m.setAttribute(\x22id\x22,o+\x22_form\x22),m.setAttribute(\x22method\x22,\x22post\x22),m.setAttribute(\x22enctype\x22,\x22multipart/form-data\x22),m.setAttribute(\x22encoding\x22,\x22multipart/form-data\x22),c.extend(m.style,{overflow:\x22hidden\x22,position:\x22absolute\x22,top:0,left:0,width:\x22100%\x22,height:\x22100%\x22}),n=document.createElement(\x22input\x22),n.setAttribute(\x22id\x22,o),n.setAttribute(\x22type\x22,\x22file\x22),n.setAttribute(\x22name\x22,i.name||\x22Filedata\x22),n.setAttribute(\x22accept\x22,j.join(\x22,\x22)),c.extend(n.style,{fontSize:\x22999px\x22,opacity:0}),m.appendChild(n),f.appendChild(m),c.extend(n.style,{position:\x22absolute\x22,top:0,left:0,width:\x22100%\x22,height:\x22100%\x22}),\x22IE\x22===g.browser&&g.verComp(g.version,10,\x22\x3c\x22)&&c.extend(n.style,{filter:\x22progid:DXImageTransform.Microsoft.Alpha(opacity=0)\x22}),n.onchange=function(){var c;if(this.value){if(this.files){if(c=this.files[0],0===c.size)return void m.parentNode.removeChild(m)}else c={name:this.value};c=new b(q.uid,c),this.onchange=function(){},a.call(p),p.files=[c],n.setAttribute(\x22id\x22,c.uid),m.setAttribute(\x22id\x22,c.uid+\x22_form\x22),p.trigger(\x22change\x22),n=m=null}},q.can(\x22summon_file_dialog\x22)&&(k=d.get(i.browse_button),e.removeEvent(k,\x22click\x22,p.uid),e.addEvent(k,\x22click\x22,function(a){n&&!n.disabled&&n.click(),a.preventDefault()},p.uid)),h=o,f=l=k=null}var h,i,j=[];c.extend(this,{init:function(b){var c,g=this,h=g.getRuntime();i=b,j=b.accept.mimes||f.extList2mimes(b.accept,h.can(\x22filter_by_extension\x22)),c=h.getShimContainer(),function(){var a,f,i;a=d.get(b.browse_button),h.can(\x22summon_file_dialog\x22)&&(\x22static\x22===d.getStyle(a,\x22position\x22)&&(a.style.position=\x22relative\x22),f=parseInt(d.getStyle(a,\x22z-index\x22),10)||1,a.style.zIndex=f,c.style.zIndex=f-1),i=h.can(\x22summon_file_dialog\x22)?a:c,e.addEvent(i,\x22mouseover\x22,function(){g.trigger(\x22mouseenter\x22)},g.uid),e.addEvent(i,\x22mouseout\x22,function(){g.trigger(\x22mouseleave\x22)},g.uid),e.addEvent(i,\x22mousedown\x22,function(){g.trigger(\x22mousedown\x22)},g.uid),e.addEvent(d.get(b.container),\x22mouseup\x22,function(){g.trigger(\x22mouseup\x22)},g.uid),a=null}(),a.call(this),c=null,g.trigger({type:\x22ready\x22,async:!0})},disable:function(a){var b;(b=d.get(h))&&(b.disabled=!!a)},destroy:function(){var a=this.getRuntime(),b=a.getShim(),c=a.getShimContainer();e.removeAllEvents(c,this.uid),e.removeAllEvents(i&&d.get(i.container),this.uid),e.removeAllEvents(i&&d.get(i.browse_button),this.uid),c&&(c.innerHTML=\x22\x22),b.removeInstance(this.uid),h=j=i=c=b=null}})}return a.FileInput=h}),d(\x22moxie/runtime/html4/file/FileReader\x22,[\x22moxie/runtime/html4/Runtime\x22,\x22moxie/runtime/html5/file/FileReader\x22],function(a,b){return a.FileReader=b}),d(\x22moxie/runtime/html4/xhr/XMLHttpRequest\x22,[\x22moxie/runtime/html4/Runtime\x22,\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/utils/Url\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/utils/Events\x22,\x22moxie/file/Blob\x22,\x22moxie/xhr/FormData\x22],function(a,b,c,d,e,f,g,h){function i(){function a(a){var b,d,e,g,h=this,i=!1;if(k){if(b=k.id.replace(/_iframe$/,\x22\x22),d=c.get(b+\x22_form\x22)){for(e=d.getElementsByTagName(\x22input\x22),g=e.length;g--;)switch(e[g].getAttribute(\x22type\x22)){case\x22hidden\x22:e[g].parentNode.removeChild(e[g]);break;case\x22file\x22:i=!0}e=[],i||d.parentNode.removeChild(d),d=null}setTimeout(function(){f.removeEvent(k,\x22load\x22,h.uid),k.parentNode&&k.parentNode.removeChild(k);var b=h.getRuntime().getShimContainer();b.children.length||b.parentNode.removeChild(b),b=k=null,a()},1)}}var i,j,k;b.extend(this,{send:function(l,m){function n(){var c=t.getShimContainer()||document.body,e=document.createElement(\x22div\x22);e.innerHTML=\x27\x3ciframe id=\x22\x27+o+\x27_iframe\x22 name=\x22\x27+o+\x27_iframe\x22 src=\x22javascript:&quot;&quot;\x22 style=\x22display:none\x22\x3e\x3c/iframe\x3e\x27,k=e.firstChild,c.appendChild(k),f.addEvent(k,\x22load\x22,function(){var c;try{c=k.contentWindow.document||k.contentDocument||window.frames[k.id].document,/^4(0[0-9]|1[0-7]|2[2346])\x5cs/.test(c.title)?i=c.title.replace(/^(\x5cd+).*$/,\x22$1\x22):(i=200,j=b.trim(c.body.innerHTML),s.trigger({type:\x22progress\x22,loaded:j.length,total:j.length}),r&&s.trigger({type:\x22uploadprogress\x22,loaded:r.size||1025,total:r.size||1025}))}catch(e){if(!d.hasSameOrigin(l.url))return void a.call(s,function(){s.trigger(\x22error\x22)});i=404}a.call(s,function(){s.trigger(\x22load\x22)})},s.uid)}var o,p,q,r,s=this,t=s.getRuntime();if(i=j=null,m instanceof h&&m.hasBlob()){if(r=m.getBlob(),o=r.uid,q=c.get(o),p=c.get(o+\x22_form\x22),!p)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR)}else o=b.guid(\x22uid_\x22),p=document.createElement(\x22form\x22),p.setAttribute(\x22id\x22,o+\x22_form\x22),p.setAttribute(\x22method\x22,l.method),p.setAttribute(\x22enctype\x22,\x22multipart/form-data\x22),p.setAttribute(\x22encoding\x22,\x22multipart/form-data\x22),t.getShimContainer().appendChild(p);p.setAttribute(\x22target\x22,o+\x22_iframe\x22),m instanceof h&&m.each(function(a,c){if(a instanceof g)q&&q.setAttribute(\x22name\x22,c);else{var d=document.createElement(\x22input\x22);b.extend(d,{type:\x22hidden\x22,name:c,value:a}),q?p.insertBefore(d,q):p.appendChild(d)}}),p.setAttribute(\x22action\x22,l.url),n(),p.submit(),s.trigger(\x22loadstart\x22)},getStatus:function(){return i},getResponse:function(a){if(\x22json\x22===a&&\x22string\x22===b.typeOf(j)&&window.JSON)try{return JSON.parse(j.replace(/^\x5cs*\x3cpre[^\x3e]*\x3e/,\x22\x22).replace(/\x3c\x5c/pre\x3e\x5cs*$/,\x22\x22))}catch(c){return null}return j},abort:function(){var b=this;k&&k.contentWindow&&(k.contentWindow.stop?k.contentWindow.stop():k.contentWindow.document.execCommand?k.contentWindow.document.execCommand(\x22Stop\x22):k.src=\x22about:blank\x22),a.call(this,function(){b.dispatchEvent(\x22abort\x22)})}})}return a.XMLHttpRequest=i}),d(\x22moxie/runtime/html4/image/Image\x22,[\x22moxie/runtime/html4/Runtime\x22,\x22moxie/runtime/html5/image/Image\x22],function(a,b){return a.Image=b}),f([\x22moxie/core/utils/Basic\x22,\x22moxie/core/utils/Env\x22,\x22moxie/core/I18n\x22,\x22moxie/core/utils/Mime\x22,\x22moxie/core/utils/Dom\x22,\x22moxie/core/Exceptions\x22,\x22moxie/core/EventTarget\x22,\x22moxie/runtime/Runtime\x22,\x22moxie/runtime/RuntimeClient\x22,\x22moxie/file/FileInput\x22,\x22moxie/core/utils/Encode\x22,\x22moxie/file/Blob\x22,\x22moxie/file/File\x22,\x22moxie/file/FileDrop\x22,\x22moxie/file/FileReader\x22,\x22moxie/core/utils/Url\x22,\x22moxie/runtime/RuntimeTarget\x22,\x22moxie/file/FileReaderSync\x22,\x22moxie/xhr/FormData\x22,\x22moxie/xhr/XMLHttpRequest\x22,\x22moxie/runtime/Transporter\x22,\x22moxie/image/Image\x22,\x22moxie/core/utils/Events\x22])}(this),function(a){\x22use strict\x22;var b={},c=a.moxie.core.utils.Basic.inArray;return function d(a){var e,f;for(e in a)f=typeof a[e],\x22object\x22!==f||~c(e,[\x22Exceptions\x22,\x22Env\x22,\x22Mime\x22])?\x22function\x22===f&&(b[e]=a[e]):d(a[e])}(a.moxie),b.Env=a.moxie.core.utils.Env,b.Mime=a.moxie.core.utils.Mime,b.Exceptions=a.moxie.core.Exceptions,a.mOxie=b,a.o||(a.o=b),b}(this);\x1f'}